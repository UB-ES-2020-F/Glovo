õ
S/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/AppConfiguration.cs
	namespace 	
glovo_webapi
 
{ 
public 

class 
AppConfiguration !
{ 
public 
string 
Secret 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} Î.
f/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Orders/OrdersController.cs
	namespace 	
glovo_webapi
 
. 
Controllers "
." #
Orders# )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
OrdersController !
:" #
ControllerBase$ 2
{ 
private 
readonly 
IOrdersService '
_service( 0
;0 1
private 
readonly 
IMapper  
_mapper! (
;( )
public 
OrdersController 
(  
IOrdersService  .
service/ 6
,6 7
IMapper8 ?
mapper@ F
)F G
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
IEnumerable '
<' (
GetOrderModel( 5
>5 6
>6 7
GetAllOrders8 D
(D E
)E F
{ 	
IEnumerable 
< 
Order 
> 
orders %
=& '
_service( 0
.0 1
GetAllOrders1 =
(= >
)> ?
;? @
return   
Ok   
(   
_mapper   
.   
Map   !
<  ! "
IEnumerable  " -
<  - .
GetOrderModel  . ;
>  ; <
>  < =
(  = >
orders  > D
)  D E
)  E F
;  F G
}!! 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
ActionResult%% 
<%% 
GetOrderModel%% )
>%%) *
GetOrderById%%+ 7
(%%7 8
int%%8 ;
orderId%%< C
)%%C D
{&& 	
Order'' 

foundOrder'' 
='' 
_service'' '
.''' (
GetOrderById''( 4
(''4 5
orderId''5 <
)''< =
;''= >
if(( 
((( 

foundOrder(( 
==(( 
null(( "
)((" #
{(($ %
return((& ,
NotFound((- 5
(((5 6
new((6 9
{((: ;
message((; B
=((C D
$str((E Y
}((Y Z
)((Z [
;(([ \
}((] ^
return)) 
Ok)) 
()) 
_mapper)) 
.)) 
Map)) !
<))! "
GetOrderModel))" /
>))/ 0
())0 1

foundOrder))1 ;
))); <
)))< =
;))= >
}** 	
[-- 	
	Authorize--	 
]-- 
[.. 	
HttpPost..	 
].. 
public// 
ActionResult// 
<// 
GetOrderModel// )
>//) *
	PostOrder//+ 4
(//4 5
[//5 6
FromBody//6 >
]//> ?
PostOrderModel//@ N
postOrderModel//O ]
)//] ^
{00 	
Order11 
order11 
=11 
_mapper11 !
.11! "
Map11" %
<11% &
PostOrderModel11& 4
,114 5
Order116 ;
>11; <
(11< =
postOrderModel11= K
)11K L
;11L M
Order22 

addedOrder22 
=22 
null22 #
;22# $
try33 
{44 

addedOrder55 
=55 
_service55 %
.55% &
AddOrder55& .
(55. /
order55/ 4
)554 5
;555 6
}66 
catch77 
(77 
RequestException77 #
ex77$ &
)77& '
{88 
if99 
(99 
ex99 
.99 
Code99 
==99 
OrderExceptionCodes99 2
.992 3
RestaurantNotFound993 E
)99E F
{:: 
return;; 

BadRequest;; %
(;;% &
new;;& )
{;;* +
error;;, 1
=;;1 2
$str;;2 A
,;;A B
message;;B I
=;;J K
$str;;L g
};;h i
);;i j
;;;j k
}<< 
if== 
(== 
ex== 
.== 
Code== 
==== 
OrderExceptionCodes== 2
.==2 3
ProductNotFound==3 B
)==B C
{>> 
return?? 

BadRequest?? %
(??% &
new??& )
{??* +
error??, 1
=??1 2
$str??2 A
,??A B
message??B I
=??J K
$str??L d
}??e f
)??f g
;??g h
}@@ 
ifAA 
(AA 
exAA 
.AA 
CodeAA 
==AA 
OrderExceptionCodesAA 2
.AA2 3
BadOrderProductAA3 B
)AAB C
{BB 
returnCC 

BadRequestCC %
(CC% &
newCC& )
{CC* +
errorCC, 1
=CC1 2
$strCC2 A
,CCA B
messageCCB I
=CCJ K
$strCCL c
}CCd e
)CCe f
;CCf g
}DD 
returnEE 

BadRequestEE !
(EE! "
newEE" %
{EE& '
messageEE' .
=EE/ 0
$strEE1 @
}EE@ A
)EEA B
;EEB C
}FF 
returnHH 
OkHH 
(HH 
_mapperHH 
.HH 
MapHH !
<HH! "
OrderHH" '
,HH' (
GetOrderModelHH) 6
>HH6 7
(HH7 8

addedOrderHH8 B
)HHB C
)HHC D
;HHD E
}II 	
}JJ 
}KK ≠
r/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Orders/OrdersOfRestaurantController.cs
	namespace 	
glovo_webapi
 
. 
Controllers "
." #
Orders# )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class (
OrdersOfRestaurantController -
:. /
ControllerBase0 >
{ 
private 
readonly 
IOrdersService '
_service( 0
;0 1
private 
readonly 
IMapper  
_mapper! (
;( )
public (
OrdersOfRestaurantController +
(+ ,
IOrdersService, :
service; B
,B C
IMapperD K
mapperL R
)R S
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
( 
$str "
)" #
]# $
public 
ActionResult 
< 
IEnumerable '
<' (
GetOrderModel( 5
>5 6
>6 7$
GetAllOrdersOfRestaurant8 P
(P Q
intQ T
restIdU [
)[ \
{ 	
IEnumerable 
< 
Order 
> 
restaurantOrders /
=0 1
_service2 :
.: ;$
GetAllOrdersOfRestaurant; S
(S T
restIdT Z
)Z [
;[ \
if 
( 
restaurantOrders  
==! #
null$ (
)( )
{* +
return, 2
NotFound3 ;
(; <
new< ?
{@ A
messageA H
=I J
$strK d
}d e
)e f
;f g
}h i
return   
Ok   
(   
_mapper   
.   
Map   !
<  ! "
IEnumerable  " -
<  - .
GetOrderModel  . ;
>  ; <
>  < =
(  = >
restaurantOrders  > N
)  N O
)  O P
;  P Q
}!! 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ ,
)$$, -
]$$- .
public%% 
ActionResult%% 
<%% 
GetOrderModel%% )
>%%) *&
GetProductOfRestaurantById%%+ E
(%%E F
int%%F I
restId%%J P
,%%P Q
int%%R U
orderId%%V ]
)%%] ^
{&& 	
Order'' 

foundOrder'' 
='' 
_service'' '
.''' ($
GetOrderOfRestaurantById''( @
(''@ A
restId''A G
,''G H
orderId''I P
)''P Q
;''Q R
if(( 
((( 

foundOrder(( 
==(( 
null(( "
)((" #
{(($ %
return((& ,
NotFound((- 5
(((5 6
new((6 9
{((: ;
message((; B
=((C D
$str((E j
}((j k
)((k l
;((l m
}((n o
return)) 
Ok)) 
()) 
_mapper)) 
.)) 
Map)) !
<))! "
GetOrderModel))" /
>))/ 0
())0 1

foundOrder))1 ;
))); <
)))< =
;))= >
}** 	
}++ 
},, ı
l/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Orders/OrdersOfUserController.cs
	namespace

 	
glovo_webapi


 
.

 
Controllers

 "
.

" #
Orders

# )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class "
OrdersOfUserController '
:( )
ControllerBase* 8
{ 
private 
readonly 
IOrdersService '
_service( 0
;0 1
private 
readonly 
IMapper  
_mapper! (
;( )
public "
OrdersOfUserController %
(% &
IOrdersService& 4
service5 <
,< =
IMapper> E
mapperF L
)L M
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
( 
$str "
)" #
]# $
public 
ActionResult 
< 
IEnumerable '
<' (
GetOrderModel( 5
>5 6
>6 7
GetAllOrdersOfUser8 J
(J K
intK N
userIdO U
)U V
{ 	
IEnumerable 
< 
Order 
> 

userOrders )
=* +
_service, 4
.4 5
GetAllOrdersOfUser5 G
(G H
userIdH N
)N O
;O P
if 
( 

userOrders 
== 
null "
)" #
{$ %
return& ,
NotFound- 5
(5 6
new6 9
{: ;
message; B
=C D
$strE X
}X Y
)Y Z
;Z [
}\ ]
return 
Ok 
( 
_mapper 
. 
Map !
<! "
IEnumerable" -
<- .
GetOrderModel. ;
>; <
>< =
(= >

userOrders> H
)H I
)I J
;J K
}   	
[## 	
HttpGet##	 
(## 
$str## ,
)##, -
]##- .
public$$ 
ActionResult$$ 
<$$ 
GetOrderModel$$ )
>$$) *
GetOrderOfUserById$$+ =
($$= >
int$$> A
userId$$B H
,$$H I
int$$J M
orderId$$N U
)$$U V
{%% 	
Order&& 

foundOrder&& 
=&& 
_service&& '
.&&' ($
GetOrderOfRestaurantById&&( @
(&&@ A
userId&&A G
,&&G H
orderId&&I P
)&&P Q
;&&Q R
if'' 
('' 

foundOrder'' 
=='' 
null'' "
)''" #
{''$ %
return''& ,
NotFound''- 5
(''5 6
new''6 9
{'': ;
message''; B
=''C D
$str''E d
}''d e
)''e f
;''f g
}''h i
return(( 
Ok(( 
((( 
_mapper(( 
.(( 
Map(( !
<((! "
GetOrderModel((" /
>((/ 0
(((0 1

foundOrder((1 ;
)((; <
)((< =
;((= >
})) 	
}** 
}++ Ω
j/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Products/ProductsController.cs
	namespace

 	
glovo_webapi


 
.

 
Controllers

 "
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
ProductsController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
IProductsService )
_service* 2
;2 3
private 
readonly 
IMapper  
_mapper! (
;( )
public 
ProductsController !
(! "
IProductsService" 2
service3 :
,: ;
IMapper< C
mapperD J
)J K
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
IEnumerable '
<' (
ProductReadModel( 8
>8 9
>9 :
GetAllProducts; I
(I J
[J K
	FromQueryK T
]T U
ProductCategoryU d
?d e
categoryf n
)n o
{ 	
IEnumerable 
< 
Product 
>  
products! )
;) *
if 
( 
category 
. 
HasValue !
)! "
{   
Console!! 
.!! 
Write!! 
(!! 
$str!! *
+!!* +
category!!+ 3
.!!3 4
Value!!4 9
+!!9 :
$str!!: >
)!!> ?
;!!? @
products"" 
="" 
_service"" #
.""# $!
GetProductsByCategory""$ 9
(""9 :
category"": B
.""B C
Value""C H
)""H I
;""I J
}## 
else$$ 
{%% 
Console&& 
.&& 
Write&& 
(&& 
$str&& 0
)&&0 1
;&&1 2
products'' 
='' 
_service'' #
.''# $
GetAllProducts''$ 2
(''2 3
)''3 4
;''4 5
}(( 
return)) 
Ok)) 
()) 
_mapper)) 
.)) 
Map)) !
<))! "
IEnumerable))" -
<))- .
ProductReadModel)). >
>))> ?
>))? @
())@ A
products))A I
)))I J
)))J K
;))K L
}** 	
[-- 	
HttpGet--	 
(-- 
$str-- 
)-- 
]-- 
public.. 
ActionResult.. 
<.. 
ProductReadModel.. ,
>.., -
GetProductById... <
(..< =
int..= @
prodId..A G
)..G H
{// 	
Product00 
foundProduct00  
=00! "
_service00# +
.00+ ,
GetProductById00, :
(00: ;
prodId00; A
)00A B
;00B C
if11 
(11 
foundProduct11 
==11 
null11  $
)11$ %
{22 
return33 
NotFound33 
(33  
new33  #
{33$ %
message33% ,
=33- .
$str33/ E
}33E F
)33F G
;33G H
}44 
return55 
Ok55 
(55 
_mapper55 
.55 
Map55 !
<55! "
ProductReadModel55" 2
>552 3
(553 4
foundProduct554 @
)55@ A
)55A B
;55B C
}66 	
}77 
}88 « 
v/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Products/ProductsOfRestaurantController.cs
	namespace

 	
glovo_webapi


 
.

 
Controllers

 "
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class *
ProductsOfRestaurantController /
:0 1
ControllerBase2 @
{ 
private 
readonly 
IProductsService )
_service* 2
;2 3
private 
readonly 
IMapper  
_mapper! (
;( )
public *
ProductsOfRestaurantController -
(- .
IProductsService. >
service? F
,F G
IMapperH O
mapperP V
)V W
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
( 
$str $
)$ %
]% &
public 
ActionResult 
< 
ProductReadModel ,
>, -&
GetAllProductsOfRestaurant. H
(H I
intI L
idRestM S
,S T
[U V
	FromQueryV _
]_ `
ProductCategory` o
?o p
categoryq y
)y z
{ 	
IEnumerable 
< 
Product 
>  
products! )
;) *
if 
( 
category 
. 
HasValue !
)! "
{ 
products 
= 
_service #
.# $0
$GetAllProductsOfRestaurantByCategory$ H
(H I
idRestI O
,O P
categoryQ Y
.Y Z
ValueZ _
)_ `
;` a
}   
else!! 
{"" 
products## 
=## 
_service## #
.### $&
GetAllProductsOfRestaurant##$ >
(##> ?
idRest##? E
)##E F
;##F G
}$$ 
if&& 
(&& 
products&& 
==&& 
null&&  
)&&  !
{'' 
return(( 
NotFound(( 
(((  
new((  #
{(($ %
message((% ,
=((- .
$str((/ H
}((H I
)((I J
;((J K
})) 
return** 
Ok** 
(** 
_mapper** 
.** 
Map** !
<**! "
IEnumerable**" -
<**- .
ProductReadModel**. >
>**> ?
>**? @
(**@ A
products**A I
)**I J
)**J K
;**K L
}++ 	
[.. 	
HttpGet..	 
(.. 
$str.. -
)..- .
]... /
public// 
ActionResult// 
<// 
ProductReadModel// ,
>//, -&
GetProductOfRestaurantById//. H
(//H I
int//I L
restId//M S
,//S T
int//U X
prodId//Y _
)//_ `
{00 	
Product11 
foundProduct11  
=11! "
_service11# +
.11+ ,&
GetProductOfRestaurantById11, F
(11F G
restId11G M
,11M N
prodId11O U
)11U V
;11V W
if22 
(22 
foundProduct22 
==22 
null22  $
)22$ %
{33 
return44 
NotFound44 
(44  
new44  #
{44$ %
message44% ,
=44- .
$str44/ S
}44S T
)44T U
;44U V
}55 
return66 
Ok66 
(66 
_mapper66 
.66 
Map66 !
<66! "
ProductReadModel66" 2
>662 3
(663 4
foundProduct664 @
)66@ A
)66A B
;66B C
}77 	
}88 
}99 É
p/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Restaurants/RestaurantsController.cs
	namespace 	
glovo_webapi
 
. 
Controllers "
{		 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
public 

class !
RestaurantsController &
:' (
ControllerBase) 7
{ 
private 
readonly 
IRestaurantsService ,
_service- 5
;5 6
private 
readonly 
IMapper  
_mapper! (
;( )
public !
RestaurantsController $
($ %
IRestaurantsService% 8
service9 @
,@ A
IMapperB I
mapperJ P
)P Q
{ 	
_service 
= 
service 
; 
_mapper 
= 
mapper 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
IEnumerable '
<' (
RestaurantReadModel( ;
>; <
>< =
GetAllRestaurants> O
(O P
)P Q
{ 	
IEnumerable 
< 

Restaurant "
>" #
restaurants$ /
=0 1
_service2 :
.: ;
GetAllRestaurants; L
(L M
)M N
;N O
return 
Ok 
( 
_mapper 
. 
Map !
<! "
IEnumerable" -
<- .
RestaurantReadModel. A
>A B
>B C
(C D
restaurantsD O
)O P
)P Q
;Q R
} 	
[   	
HttpGet  	 
(   
$str   
)   
]   
public!! 
ActionResult!! 
<!! 
RestaurantReadModel!! /
>!!/ 0
GetRestaurantById!!1 B
(!!B C
int!!C F
restId!!G M
)!!M N
{"" 	

Restaurant## 
foundRestaurant## &
=##' (
_service##) 1
.##1 2
GetRestaurantById##2 C
(##C D
restId##D J
)##J K
;##K L
if$$ 
($$ 
foundRestaurant$$ 
==$$  "
null$$# '
)$$' (
{%% 
return&& 
NotFound&& 
(&&  
new&&  #
{&&$ %
message&&% ,
=&&- .
$str&&/ H
}&&H I
)&&I J
;&&J K
}'' 
return(( 
Ok(( 
((( 
_mapper(( 
.(( 
Map(( !
<((! "
RestaurantReadModel((" 5
>((5 6
(((6 7
foundRestaurant((7 F
)((F G
)((G H
;((H I
})) 	
}** 
}++ àb
d/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Controllers/Users/UsersController.cs
	namespace 	
glovo_webapi
 
. 
Controllers "
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
UsersController  
:! "
ControllerBase# 1
{ 
private 
IUserService 
_userService )
;) *
private 
IMapper 
_mapper 
;  
private 
readonly 
IOptions !
<! "
AppConfiguration" 2
>2 3
_configuration4 B
;B C
public 
UsersController 
( 
IUserService 
userService $
,$ %
IMapper 
mapper 
, 
IOptions   
<   
AppConfiguration   %
>  % &
configuration  ' 4
)  4 5
{!! 	
_userService"" 
="" 
userService"" &
;""& '
_mapper## 
=## 
mapper## 
;## 
_configuration$$ 
=$$ 
configuration$$ *
;$$* +
}%% 	
[(( 	
AllowAnonymous((	 
](( 
[)) 	
HttpPost))	 
()) 
$str)) 
))) 
])) 
public** 
IActionResult** 
Authenticate** )
(**) *
[*** +
FromBody**+ 3
]**3 4

LoginModel**4 >
model**? D
)**D E
{++ 	
User,, 
user,, 
=,, 
null,, 
;,, 
try-- 
{-- 
user.. 
=.. 
_userService.. #
...# $
Authenticate..$ 0
(..0 1
model..1 6
...6 7
Email..7 <
,..< =
model..> C
...C D
Password..D L
)..L M
;..M N
}// 
catch// 
(// 
RequestException// %
)//% &
{//' (
return00 

BadRequest00 !
(00! "
new00" %
{00& '
error00( -
=00- .
$str00. 8
,008 9
message00: A
=00B C
$str00D d
}00e f
)00f g
;00g h
}11 
var33 
tokenHandler33 
=33 
new33 "#
JwtSecurityTokenHandler33# :
(33: ;
)33; <
;33< =
var44 
key44 
=44 
Encoding44 
.44 
ASCII44 $
.44$ %
GetBytes44% -
(44- .
_configuration44. <
.44< =
Value44= B
.44B C
Secret44C I
)44I J
;44J K
var55 
tokenDescriptor55 
=55  !
new55" %#
SecurityTokenDescriptor55& =
{66 
Subject77 
=77 
new77 
ClaimsIdentity77 ,
(77, -
new77- 0
[770 1
]771 2
{773 4
new775 8
Claim779 >
(77> ?
$str77? C
,77C D
user77E I
.77I J
Id77J L
.77L M
ToString77M U
(77U V
)77V W
)77W X
}77Y Z
)77Z [
,77[ \
Expires88 
=88 
DateTime88 "
.88" #
UtcNow88# )
.88) *
AddDays88* 1
(881 2
$num882 3
)883 4
,884 5
SigningCredentials99 "
=99# $
new99% (
SigningCredentials99) ;
(99; <
new99< ? 
SymmetricSecurityKey99@ T
(99T U
key99U X
)99X Y
,99Y Z
SecurityAlgorithms99[ m
.99m n 
HmacSha256Signature	99n Å
)
99Å Ç
}:: 
;:: 
var;; 
token;; 
=;; 
tokenHandler;; $
.;;$ %
CreateToken;;% 0
(;;0 1
tokenDescriptor;;1 @
);;@ A
;;;A B
var<< 
tokenString<< 
=<< 
tokenHandler<< *
.<<* +

WriteToken<<+ 5
(<<5 6
token<<6 ;
)<<; <
;<<< =
return?? 
Ok?? 
(?? 
new?? 
{@@ 
IdAA 
=AA 
userAA 
.AA 
IdAA 
,AA 
NameBB 
=BB 
userBB 
.BB 
NameBB  
,BB  !
EmailCC 
=CC 
userCC 
.CC 
EmailCC "
,CC" #
TokenDD 
=DD 
tokenStringDD #
}EE 
)EE 
;EE 
}FF 	
[II 	
AllowAnonymousII	 
]II 
[JJ 	
HttpPostJJ	 
(JJ 
$strJJ 
)JJ 
]JJ 
publicKK 
IActionResultKK 
RegisterKK %
(KK% &
[KK& '
FromBodyKK' /
]KK/ 0
RegisterModelKK0 =
modelKK> C
)KKC D
{LL 	
varNN 
userNN 
=NN 
_mapperNN 
.NN 
MapNN "
<NN" #
UserNN# '
>NN' (
(NN( )
modelNN) .
)NN. /
;NN/ 0
tryPP 
{PP 
_userServiceRR 
.RR 
CreateRR #
(RR# $
userRR$ (
,RR( )
modelRR* /
.RR/ 0
PasswordRR0 8
)RR8 9
;RR9 :
returnSS 
OkSS 
(SS 
)SS 
;SS 
}TT 
catchTT 
(TT 
RequestExceptionTT %
exTT& (
)TT( )
{TT* +
ifVV 
(VV 
exVV 
.VV 
CodeVV 
==VV 
UserExceptionCodesVV 1
.VV1 2
BadPasswordVV2 =
)VV= >
{WW 
returnXX 

BadRequestXX %
(XX% &
newXX& )
{XX* +
errorXX, 1
=XX1 2
$strXX2 <
,XX< =
messageXX= D
=XXE F
$strXXG k
}XXl m
)XXm n
;XXn o
}YY 
elseZZ 
ifZZ 
(ZZ 
exZZ 
.ZZ 
CodeZZ  
==ZZ! #
UserExceptionCodesZZ$ 6
.ZZ6 7
UserAlreadyExistsZZ7 H
)ZZH I
{[[ 
return\\ 

BadRequest\\ %
(\\% &
new\\& )
{\\* +
error\\, 1
=\\1 2
$str\\2 <
,\\< =
message\\= D
=\\E F
$str\\G ]
}\\^ _
)\\_ `
;\\` a
}]] 
return^^ 

BadRequest^^ !
(^^! "
new^^" %
{^^& '
message^^' .
=^^/ 0
$str^^1 @
}^^@ A
)^^A B
;^^B C
}__ 
}`` 	
[cc 	
HttpGetcc	 
]cc 
publicdd 
IActionResultdd 
GetAlldd #
(dd# $
)dd$ %
{ee 	
varff 
usersff 
=ff 
_userServiceff $
.ff$ %
GetAllff% +
(ff+ ,
)ff, -
;ff- .
vargg 
modelgg 
=gg 
_mappergg 
.gg  
Mapgg  #
<gg# $
IListgg$ )
<gg) *
	UserModelgg* 3
>gg3 4
>gg4 5
(gg5 6
usersgg6 ;
)gg; <
;gg< =
returnhh 
Okhh 
(hh 
modelhh 
)hh 
;hh 
}ii 	
[ll 	
HttpGetll	 
(ll 
$strll 
)ll 
]ll 
publicmm 
IActionResultmm 
GetByIdmm $
(mm$ %
intmm% (
userIdmm) /
)mm/ 0
{nn 	
Useroo 
useroo 
=oo 
nulloo 
;oo 
trypp 
{qq 
userrr 
=rr 
_userServicerr #
.rr# $
GetByIdrr$ +
(rr+ ,
userIdrr, 2
)rr2 3
;rr3 4
}ss 
catchtt 
(tt 
RequestExceptiontt #
)tt# $
{uu 
returnvv 
NotFoundvv 
(vv  
newvv  #
{vv$ %
messagevv% ,
=vv- .
$strvv/ B
}vvB C
)vvC D
;vvD E
}ww 
varxx 
modelxx 
=xx 
_mapperxx 
.xx  
Mapxx  #
<xx# $
	UserModelxx$ -
>xx- .
(xx. /
userxx/ 3
)xx3 4
;xx4 5
returnyy 
Okyy 
(yy 
modelyy 
)yy 
;yy 
}zz 	
[}} 	
HttpPut}}	 
(}} 
$str}} 
)}} 
]}} 
public~~ 
IActionResult~~ 
Update~~ #
(~~# $
int~~$ '
userId~~( .
,~~. /
[~~0 1
FromBody~~1 9
]~~9 :
UpdateUserModel~~: I
model~~J O
)~~O P
{ 	
var
ÅÅ 
user
ÅÅ 
=
ÅÅ 
_mapper
ÅÅ 
.
ÅÅ 
Map
ÅÅ "
<
ÅÅ" #
User
ÅÅ# '
>
ÅÅ' (
(
ÅÅ( )
model
ÅÅ) .
)
ÅÅ. /
;
ÅÅ/ 0
user
ÇÇ 
.
ÇÇ 
Id
ÇÇ 
=
ÇÇ 
userId
ÇÇ 
;
ÇÇ 
try
ÑÑ 
{
ÖÖ 
_userService
áá 
.
áá 
Update
áá #
(
áá# $
user
áá$ (
,
áá( )
model
áá* /
.
áá/ 0
Password
áá0 8
)
áá8 9
;
áá9 :
return
àà 
Ok
àà 
(
àà 
)
àà 
;
àà 
}
ââ 
catch
ää 
(
ää 
RequestException
ää #
ex
ää$ &
)
ää& '
{
ãã 
if
åå 
(
åå 
ex
åå 
.
åå 
Code
åå 
==
åå  
UserExceptionCodes
åå 1
.
åå1 2
BadPassword
åå2 =
)
åå= >
{
çç 
return
éé 

BadRequest
éé %
(
éé% &
new
éé& )
{
éé* +
error
éé, 1
=
éé1 2
$str
éé2 A
,
ééA B
message
ééB I
=
ééJ K
$str
ééL p
}
ééq r
)
éér s
;
éés t
}
èè 
else
êê 
if
êê 
(
êê 
ex
êê 
.
êê 
Code
êê  
==
êê! # 
UserExceptionCodes
êê$ 6
.
êê6 7
UserAlreadyExists
êê7 H
)
êêH I
{
ëë 
return
íí 

BadRequest
íí %
(
íí% &
new
íí& )
{
íí* +
error
íí, 1
=
íí1 2
$str
íí2 A
,
ííA B
message
ííB I
=
ííJ K
$str
ííL b
}
ííc d
)
ííd e
;
ííe f
}
ìì 
return
îî 

BadRequest
îî !
(
îî! "
new
îî" %
{
îî& '
error
îî( -
=
îî- .
$str
îî. =
,
îî= >
message
îî> E
=
îîF G
$str
îîH W
}
îîW X
)
îîX Y
;
îîY Z
}
ïï 
}
ññ 	
[
ôô 	

HttpDelete
ôô	 
(
ôô 
$str
ôô 
)
ôô 
]
ôô  
public
öö 
IActionResult
öö 
Delete
öö #
(
öö# $
int
öö$ '
userId
öö( .
)
öö. /
{
õõ 	
try
úú 
{
ùù 
_userService
ûû 
.
ûû 
Delete
ûû #
(
ûû# $
userId
ûû$ *
)
ûû* +
;
ûû+ ,
}
üü 
catch
†† 
(
†† 
RequestException
†† #
)
††# $
{
°° 
return
¢¢ 
NotFound
¢¢ 
(
¢¢  
new
¢¢  #
{
¢¢$ %
message
¢¢% ,
=
¢¢- .
$str
¢¢/ B
}
¢¢B C
)
¢¢C D
;
¢¢D E
}
££ 
return
§§ 
Ok
§§ 
(
§§ 
)
§§ 
;
§§ 
}
•• 	
}
¶¶ 
}ßß Ô
V/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Data/GlovoDBContext.cs
	namespace 	
glovo_webapi
 
. 
Data 
{ 
public 

class 
GlovoDbContext 
:  !
	DbContext" +
{ 
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{		 	
modelBuilder

 
.

 
Entity

 
<

  
OrderProduct

  ,
>

, -
(

- .
)

. /
. 
HasKey 
( 
o 
=> 
new  
{! "
o# $
.$ %
OrderId% ,
,, -
o. /
./ 0
	ProductId0 9
}: ;
); <
;< =
} 	
public 
GlovoDbContext 
( 
DbContextOptions .
<. /
GlovoDbContext/ =
>= >
opt? B
)B C
:D E
baseF J
(J K
optK N
)N O
{P Q
}R S
public 
DbSet 
< 

Restaurant 
>  
Restaurants! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Product 
> 
Products &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Order 
> 
Orders "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
OrderProduct !
>! "
OrdersProducts# 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
} 
} «
Q/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Entities/Order.cs
	namespace 	
glovo_webapi
 
. 
Entities 
{ 
public 

class 
Order 
{ 
[		 	
Key			 
]		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
DateTime 
BuyDateTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
RestaurantId 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Restaurant 

Restaurant $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
IEnumerable 
< 
OrderProduct '
>' (
OrdersProducts) 7
{8 9
get: =
;= >
set? B
;B C
}D E
} 
} Ó

X/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Entities/OrderProduct.cs
	namespace 	
glovo_webapi
 
. 
Entities 
{ 
public 

class 
OrderProduct 
{ 
[ 	
Key	 
, 
Column 
( 
Order 
= 
$num 
) 
]  
public		 
int		 
OrderId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
[ 	
Key	 
, 
Column 
( 
Order 
= 
$num 
) 
]  
public 
int 
	ProductId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Order 
Order 
{ 
get  
;  !
set" %
;% &
}' (
public 
Product 
Product 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ¬
S/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Entities/Product.cs
	namespace 	
glovo_webapi
 
. 
Entities 
{ 
public 
class 
Product 
{ 	
[		 
Key		 
]		 
public

 
int

 
Id

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
[ 
Required 
] 
public 
string 
Name "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
ImgPath %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
Description )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 
Required 
] 
public 
float 
Price "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
Required 
] 
public 
int 
RestaurantId '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
Required 
] 
public 

Restaurant !

Restaurant" ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
ProductCategory &
Category' /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
IEnumerable "
<" #
OrderProduct# /
>/ 0
OrdersProducts1 ?
{@ A
getB E
;E F
setG J
;J K
}L M
public   
Product   
(   
int   "
Id  # %
,  % &
string  ' -
Name  . 2
,  2 3
string  4 :
ImgPath  ; B
,  B C
string  D J
Description  K V
,  V W
float  X ]
Price  ^ c
,  c d
int  e h
RestaurantId  i u
)  u v
{!! 
this"" 
."" 
Id"" 
=""  !
Id""" $
;""$ %
this## 
.## 
Name## !
=##" #
Name##$ (
;##( )
this$$ 
.$$ 
ImgPath$$ $
=$$% &
ImgPath$$' .
;$$. /
this%% 
.%% 
Description%% (
=%%) *
Description%%+ 6
;%%6 7
this&& 
.&& 
Price&& "
=&&# $
Price&&% *
;&&* +
this'' 
.'' 
RestaurantId'' )
=''* +
RestaurantId'', 8
;''8 9
this(( 
.(( 
OrdersProducts(( +
=((, -
new((. 1
List((2 6
<((6 7
OrderProduct((7 C
>((C D
(((D E
)((E F
;((F G
})) 
}++ 	
},, ¡
V/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Entities/Restaurant.cs
	namespace 	
glovo_webapi
 
. 
Entities 
{ 
public 
class 

Restaurant 
{ 	
[ 
Key 
] 
public		 
int		 
Id		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
[ 
Required 
] 
public 
string 
Name "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
ImgPath %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
ICollection "
<" #
Product# *
>* +
Products, 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public 

Restaurant !
(! "
int" %
Id& (
,( )
string* 0
Name1 5
,5 6
string7 =
ImgPath> E
)E F
{ 
this 
. 
Id 
=  !
Id" $
;$ %
this 
. 
Name !
=" #
Name$ (
;( )
this 
. 
ImgPath $
=% &
ImgPath' .
;. /
} 
} 	
} ”
P/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Entities/User.cs
	namespace 	
glovo_webapi
 
. 
Entities 
{ 
public 

class 
User 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
byte 
[ 
] 
PasswordHash "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
byte		 
[		 
]		 
PasswordSalt		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
}

 
} Ã
]/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Helpers/AuthorizeAttribute.cs
[ 
AttributeUsage 
( 
AttributeTargets  
.  !
Class! &
|' (
AttributeTargets) 9
.9 :
Method: @
)@ A
]A B
public 
class 
AuthorizeAttribute 
:  !
	Attribute" +
,+ , 
IAuthorizationFilter- A
{		 
public

 

void

 
OnAuthorization

 
(

  &
AuthorizationFilterContext

  :
context

; B
)

B C
{ 
var 
user 
= 
( 
User 
) 
context  
.  !
HttpContext! ,
., -
Items- 2
[2 3
$str3 9
]9 :
;: ;
if 

( 
user 
== 
null 
) 
{ 	
context 
. 
Result 
= 
new  

JsonResult! +
(+ ,
new, /
{0 1
message2 9
=: ;
$str< J
}K L
)L M
{N O

StatusCodeP Z
=[ \
StatusCodes] h
.h i!
Status401Unauthorizedi ~
}	 Ä
;
Ä Å
} 	
} 
} ´#
X/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Helpers/JwtMiddleware.cs
	namespace 	
WebApi
 
. 
Helpers 
{ 
public 

class 
JwtMiddleware 
{ 
private 
readonly 
RequestDelegate (
_next) .
;. /
private 
readonly 
IOptions !
<! "
AppConfiguration" 2
>2 3
_configuration4 B
;B C
public 
JwtMiddleware 
( 
RequestDelegate ,
next- 1
,1 2
IOptions3 ;
<; <
AppConfiguration< L
>L M
configurationN [
)[ \
{ 	
_next 
= 
next 
; 
_configuration 
= 
configuration *
;* +
} 	
public 
async 
Task 
Invoke  
(  !
HttpContext! ,
context- 4
,4 5
IUserService6 B
userServiceC N
)N O
{ 	
var 
token 
= 
context 
.  
Request  '
.' (
Headers( /
[/ 0
$str0 ?
]? @
.@ A
FirstOrDefaultA O
(O P
)P Q
?Q R
.R S
SplitS X
(X Y
$strY \
)\ ]
.] ^
Last^ b
(b c
)c d
;d e
if 
( 
token 
!= 
null 
) 
attachUserToContext #
(# $
context$ +
,+ ,
userService- 8
,8 9
token: ?
)? @
;@ A
await   
_next   
(   
context   
)    
;    !
}!! 	
private## 
void## 
attachUserToContext## (
(##( )
HttpContext##) 4
context##5 <
,##< =
IUserService##> J
userService##K V
,##V W
string##X ^
token##_ d
)##d e
{$$ 	
try%% 
{&& 
var'' 
tokenHandler''  
=''! "
new''# &#
JwtSecurityTokenHandler''' >
(''> ?
)''? @
;''@ A
var(( 
key(( 
=(( 
Encoding(( "
.((" #
ASCII((# (
.((( )
GetBytes(() 1
(((1 2
_configuration((2 @
.((@ A
Value((A F
.((F G
Secret((G M
)((M N
;((N O
tokenHandler)) 
.)) 
ValidateToken)) *
())* +
token))+ 0
,))0 1
new))2 5%
TokenValidationParameters))6 O
{** $
ValidateIssuerSigningKey++ ,
=++- .
true++/ 3
,++3 4
IssuerSigningKey,, $
=,,% &
new,,' * 
SymmetricSecurityKey,,+ ?
(,,? @
key,,@ C
),,C D
,,,D E
ValidateIssuer-- "
=--# $
false--% *
,--* +
ValidateAudience.. $
=..% &
false..' ,
,.., -
	ClockSkew00 
=00 
TimeSpan00  (
.00( )
Zero00) -
}11 
,11 
out11 
SecurityToken11 $
validatedToken11% 3
)113 4
;114 5
var22 
jwtToken22 
=22 
(22  
JwtSecurityToken22  0
)220 1
validatedToken221 ?
;22? @
var33 
userId33 
=33 
int33  
.33  !
Parse33! &
(33& '
jwtToken33' /
.33/ 0
Claims330 6
.336 7
First337 <
(33< =
x33= >
=>33? A
x33B C
.33C D
Type33D H
==33I K
$str33L P
)33P Q
.33Q R
Value33R W
)33W X
;33X Y
context55 
.55 
Items55 
[55 
$str55 $
]55$ %
=55& '
userService55( 3
.553 4
GetById554 ;
(55; <
userId55< B
)55B C
;55C D
}66 
catch77 
{88 
};; 
}<< 	
}== 
}>> Ï
m/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201027003800_InitialMigration.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
InitialMigration )
:* +
	Migration, 5
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
falseH M
)M N
,N O
ImgPath 
= 
table #
.# $
Column$ *
<* +
string+ 1
>1 2
(2 3
type3 7
:7 8
$str9 ?
,? @
nullableA I
:I J
trueK O
)O P
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str #
)# $
;$ %
} 	
} 
} è
n/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201030213552_InitialMigration2.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
InitialMigration2 *
:+ ,
	Migration- 6
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
}

 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ‘
n/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201101001222_MigrationProducts.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
MigrationProducts *
:+ ,
	Migration- 6
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
falseH M
)M N
,N O
ImgPath 
= 
table #
.# $
Column$ *
<* +
string+ 1
>1 2
(2 3
type3 7
:7 8
$str9 ?
,? @
nullableA I
:I J
trueK O
)O P
,P Q
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= C
,C D
nullableE M
:M N
trueO S
)S T
,T U
Price 
= 
table !
.! "
Column" (
<( )
float) .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
falseH M
)M N
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
Id; =
)= >
;> ?
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str  
)  !
;! "
} 	
}   
}!! ã
k/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201101164712_UsersMigration.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
UsersMigration '
:( )
	Migration* 3
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
trueH L
)L M
,M N
Email 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 =
,= >
nullable? G
:G H
trueI M
)M N
,N O
PasswordHash  
=! "
table# (
.( )
Column) /
</ 0
byte0 4
[4 5
]5 6
>6 7
(7 8
type8 <
:< =
$str> E
,E F
nullableG O
:O P
trueQ U
)U V
,V W
PasswordSalt  
=! "
table# (
.( )
Column) /
</ 0
byte0 4
[4 5
]5 6
>6 7
(7 8
type8 <
:< =
$str> E
,E F
nullableG O
:O P
trueQ U
)U V
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% /
,/ 0
x1 2
=>3 5
x6 7
.7 8
Id8 :
): ;
;; <
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str 
) 
; 
}   	
}!! 
}"" ¯
z/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201101183159_MigrationProductsOfRestaurant.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class )
MigrationProductsOfRestaurant 6
:7 8
	Migration9 B
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
	AddColumn		 &
<		& '
int		' *
>		* +
(		+ ,
name

 
:

 
$str

 
,

 
table 
: 
$str !
,! "
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue 
: 
$num 
)  
;  !
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str 
, 
table 
: 
$str !
)! "
;" #
} 	
} 
} ˘
c/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201103094826_Deploy.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
Deploy 
:  !
	Migration" +
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
}

 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ¶
k/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201105183408_ProductsUpdate.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
ProductsUpdate '
:( )
	Migration* 3
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
RenameColumn		 )
(		) *
name

 
:

 
$str

 
,

 
table 
: 
$str !
,! "
newName 
: 
$str !
)! "
;" #
migrationBuilder 
. 
CreateIndex (
(( )
name 
: 
$str *
,* +
table 
: 
$str !
,! "
column 
: 
$str  
)  !
;! "
migrationBuilder 
. 
AddForeignKey *
(* +
name 
: 
$str 6
,6 7
table 
: 
$str !
,! "
column 
: 
$str  
,  !
principalTable 
: 
$str  -
,- .
principalColumn 
:  
$str! %
,% &
onDelete 
: 
ReferentialAction +
.+ ,
Cascade, 3
)3 4
;4 5
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str 6
,6 7
table   
:   
$str   !
)  ! "
;  " #
migrationBuilder"" 
."" 
	DropIndex"" &
(""& '
name## 
:## 
$str## *
,##* +
table$$ 
:$$ 
$str$$ !
)$$! "
;$$" #
migrationBuilder&& 
.&& 
RenameColumn&& )
(&&) *
name'' 
:'' 
$str'' 
,'' 
table(( 
:(( 
$str(( !
,((! "
newName)) 
:)) 
$str)) !
)))! "
;))" #
}** 	
}++ 
},, õ
l/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201105192026_ProductsUpdate2.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
ProductsUpdate2 (
:) *
	Migration+ 4
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 6
,

6 7
table 
: 
$str !
)! "
;" #
migrationBuilder 
. 
RenameColumn )
() *
name 
: 
$str 
, 
table 
: 
$str !
,! "
newName 
: 
$str '
)' (
;( )
migrationBuilder 
. 
RenameIndex (
(( )
name 
: 
$str *
,* +
table 
: 
$str !
,! "
newName 
: 
$str 3
)3 4
;4 5
migrationBuilder 
. 
AddForeignKey *
(* +
name 
: 
$str <
,< =
table 
: 
$str !
,! "
column 
: 
$str &
,& '
principalTable 
: 
$str  -
,- .
principalColumn 
:  
$str! %
,% &
onDelete 
: 
ReferentialAction +
.+ ,
Cascade, 3
)3 4
;4 5
} 	
	protected   
override   
void   
Down    $
(  $ %
MigrationBuilder  % 5
migrationBuilder  6 F
)  F G
{!! 	
migrationBuilder"" 
."" 
DropForeignKey"" +
(""+ ,
name## 
:## 
$str## <
,##< =
table$$ 
:$$ 
$str$$ !
)$$! "
;$$" #
migrationBuilder&& 
.&& 
RenameColumn&& )
(&&) *
name'' 
:'' 
$str'' $
,''$ %
table(( 
:(( 
$str(( !
,((! "
newName)) 
:)) 
$str)) !
)))! "
;))" #
migrationBuilder++ 
.++ 
RenameIndex++ (
(++( )
name,, 
:,, 
$str,, 0
,,,0 1
table-- 
:-- 
$str-- !
,--! "
newName.. 
:.. 
$str.. -
)..- .
;... /
migrationBuilder00 
.00 
AddForeignKey00 *
(00* +
name11 
:11 
$str11 6
,116 7
table22 
:22 
$str22 !
,22! "
column33 
:33 
$str33  
,33  !
principalTable44 
:44 
$str44  -
,44- .
principalColumn55 
:55  
$str55! %
,55% &
onDelete66 
:66 
ReferentialAction66 +
.66+ ,
Cascade66, 3
)663 4
;664 5
}77 	
}88 
}99 •4
l/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201106001913_OrdersMigration.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
OrdersMigration (
:) *
	Migration+ 4
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
	AddColumn &
<& '
int' *
>* +
(+ ,
name 
: 
$str 
,  
table 
: 
$str !
,! "
type 
: 
$str 
,  
nullable 
: 
true 
) 
;  
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
BuyDateTime 
=  !
table" '
.' (
Column( .
<. /
DateTime/ 7
>7 8
(8 9
type9 =
:= >
$str? \
,\ ]
nullable^ f
:f g
falseh m
)m n
,n o
UserId 
= 
table "
." #
Column# )
<) *
int* -
>- .
(. /
type/ 3
:3 4
$str5 >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P
RestaurantId  
=! "
table# (
.( )
Column) /
</ 0
int0 3
>3 4
(4 5
type5 9
:9 :
$str; D
,D E
nullableF N
:N O
trueP T
)T U
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 0
,0 1
x2 3
=>4 6
x7 8
.8 9
Id9 ;
); <
;< =
table 
. 

ForeignKey $
($ %
name 
: 
$str B
,B C
column   
:   
x    !
=>  " $
x  % &
.  & '
RestaurantId  ' 3
,  3 4
principalTable!! &
:!!& '
$str!!( 5
,!!5 6
principalColumn"" '
:""' (
$str"") -
,""- .
onDelete##  
:##  !
ReferentialAction##" 3
.##3 4
Restrict##4 <
)##< =
;##= >
table$$ 
.$$ 

ForeignKey$$ $
($$$ %
name%% 
:%% 
$str%% 6
,%%6 7
column&& 
:&& 
x&&  !
=>&&" $
x&&% &
.&&& '
UserId&&' -
,&&- .
principalTable'' &
:''& '
$str''( /
,''/ 0
principalColumn(( '
:((' (
$str(() -
,((- .
onDelete))  
:))  !
ReferentialAction))" 3
.))3 4
Restrict))4 <
)))< =
;))= >
}** 
)** 
;** 
migrationBuilder,, 
.,, 
CreateIndex,, (
(,,( )
name-- 
:-- 
$str-- +
,--+ ,
table.. 
:.. 
$str.. !
,..! "
column// 
:// 
$str// !
)//! "
;//" #
migrationBuilder11 
.11 
CreateIndex11 (
(11( )
name22 
:22 
$str22 .
,22. /
table33 
:33 
$str33 
,33  
column44 
:44 
$str44 &
)44& '
;44' (
migrationBuilder66 
.66 
CreateIndex66 (
(66( )
name77 
:77 
$str77 (
,77( )
table88 
:88 
$str88 
,88  
column99 
:99 
$str99  
)99  !
;99! "
migrationBuilder;; 
.;; 
AddForeignKey;; *
(;;* +
name<< 
:<< 
$str<< 2
,<<2 3
table== 
:== 
$str== !
,==! "
column>> 
:>> 
$str>> !
,>>! "
principalTable?? 
:?? 
$str??  (
,??( )
principalColumn@@ 
:@@  
$str@@! %
,@@% &
onDeleteAA 
:AA 
ReferentialActionAA +
.AA+ ,
RestrictAA, 4
)AA4 5
;AA5 6
}BB 	
	protectedDD 
overrideDD 
voidDD 
DownDD  $
(DD$ %
MigrationBuilderDD% 5
migrationBuilderDD6 F
)DDF G
{EE 	
migrationBuilderFF 
.FF 
DropForeignKeyFF +
(FF+ ,
nameGG 
:GG 
$strGG 2
,GG2 3
tableHH 
:HH 
$strHH !
)HH! "
;HH" #
migrationBuilderJJ 
.JJ 
	DropTableJJ &
(JJ& '
nameKK 
:KK 
$strKK 
)KK 
;KK  
migrationBuilderMM 
.MM 
	DropIndexMM &
(MM& '
nameNN 
:NN 
$strNN +
,NN+ ,
tableOO 
:OO 
$strOO !
)OO! "
;OO" #
migrationBuilderQQ 
.QQ 

DropColumnQQ '
(QQ' (
nameRR 
:RR 
$strRR 
,RR  
tableSS 
:SS 
$strSS !
)SS! "
;SS" #
}TT 	
}UU 
}VV À,
m/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201106004411_OrdersMigration2.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
OrdersMigration2 )
:* +
	Migration, 5
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 2
,

2 3
table 
: 
$str !
)! "
;" #
migrationBuilder 
. 
	DropIndex &
(& '
name 
: 
$str +
,+ ,
table 
: 
$str !
)! "
;" #
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str 
,  
table 
: 
$str !
)! "
;" #
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str $
,$ %
columns 
: 
table 
=> !
new" %
{ 
OrdersId 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
type1 5
:5 6
$str7 @
,@ A
nullableB J
:J K
falseL Q
)Q R
,R S

ProductsId 
=  
table! &
.& '
Column' -
<- .
int. 1
>1 2
(2 3
type3 7
:7 8
$str9 B
,B C
nullableD L
:L M
falseN S
)S T
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 6
,6 7
x8 9
=>: <
new= @
{A B
xC D
.D E
OrdersIdE M
,M N
xO P
.P Q

ProductsIdQ [
}\ ]
)] ^
;^ _
table 
. 

ForeignKey $
($ %
name   
:   
$str   ?
,  ? @
column!! 
:!! 
x!!  !
=>!!" $
x!!% &
.!!& '
OrdersId!!' /
,!!/ 0
principalTable"" &
:""& '
$str""( 0
,""0 1
principalColumn## '
:##' (
$str##) -
,##- .
onDelete$$  
:$$  !
ReferentialAction$$" 3
.$$3 4
Cascade$$4 ;
)$$; <
;$$< =
table%% 
.%% 

ForeignKey%% $
(%%$ %
name&& 
:&& 
$str&& C
,&&C D
column'' 
:'' 
x''  !
=>''" $
x''% &
.''& '

ProductsId''' 1
,''1 2
principalTable(( &
:((& '
$str((( 2
,((2 3
principalColumn)) '
:))' (
$str))) -
,))- .
onDelete**  
:**  !
ReferentialAction**" 3
.**3 4
Cascade**4 ;
)**; <
;**< =
}++ 
)++ 
;++ 
migrationBuilder-- 
.-- 
CreateIndex-- (
(--( )
name.. 
:.. 
$str.. 2
,..2 3
table// 
:// 
$str// %
,//% &
column00 
:00 
$str00 $
)00$ %
;00% &
}11 	
	protected33 
override33 
void33 
Down33  $
(33$ %
MigrationBuilder33% 5
migrationBuilder336 F
)33F G
{44 	
migrationBuilder55 
.55 
	DropTable55 &
(55& '
name66 
:66 
$str66 $
)66$ %
;66% &
migrationBuilder88 
.88 
	AddColumn88 &
<88& '
int88' *
>88* +
(88+ ,
name99 
:99 
$str99 
,99  
table:: 
::: 
$str:: !
,::! "
type;; 
:;; 
$str;; 
,;;  
nullable<< 
:<< 
true<< 
)<< 
;<<  
migrationBuilder>> 
.>> 
CreateIndex>> (
(>>( )
name?? 
:?? 
$str?? +
,??+ ,
table@@ 
:@@ 
$str@@ !
,@@! "
columnAA 
:AA 
$strAA !
)AA! "
;AA" #
migrationBuilderCC 
.CC 
AddForeignKeyCC *
(CC* +
nameDD 
:DD 
$strDD 2
,DD2 3
tableEE 
:EE 
$strEE !
,EE! "
columnFF 
:FF 
$strFF !
,FF! "
principalTableGG 
:GG 
$strGG  (
,GG( )
principalColumnHH 
:HH  
$strHH! %
,HH% &
onDeleteII 
:II 
ReferentialActionII +
.II+ ,
RestrictII, 4
)II4 5
;II5 6
}JJ 	
}KK 
}LL ∏6
u/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201106102914_OrdersProductsMigration1.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class $
OrdersProductsMigration1 1
:2 3
	Migration4 =
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
	DropTable		 &
(		& '
name

 
:

 
$str

 $
)

$ %
;

% &
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str &
,& '
columns 
: 
table 
=> !
new" %
{ 
OrderId 
= 
table #
.# $
Column$ *
<* +
int+ .
>. /
(/ 0
type0 4
:4 5
$str6 ?
,? @
nullableA I
:I J
falseK P
)P Q
,Q R
	ProductId 
= 
table  %
.% &
Column& ,
<, -
int- 0
>0 1
(1 2
type2 6
:6 7
$str8 A
,A B
nullableC K
:K L
falseM R
)R S
,S T
Quantity 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
type1 5
:5 6
$str7 @
,@ A
nullableB J
:J K
falseL Q
)Q R
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 8
,8 9
x: ;
=>< >
new? B
{C D
xE F
.F G
OrderIdG N
,N O
xP Q
.Q R
	ProductIdR [
}\ ]
)] ^
;^ _
table 
. 

ForeignKey $
($ %
name 
: 
$str @
,@ A
column 
: 
x  !
=>" $
x% &
.& '
OrderId' .
,. /
principalTable &
:& '
$str( 0
,0 1
principalColumn '
:' (
$str) -
,- .
onDelete  
:  !
ReferentialAction" 3
.3 4
Cascade4 ;
); <
;< =
table 
. 

ForeignKey $
($ %
name 
: 
$str D
,D E
column 
: 
x  !
=>" $
x% &
.& '
	ProductId' 0
,0 1
principalTable   &
:  & '
$str  ( 2
,  2 3
principalColumn!! '
:!!' (
$str!!) -
,!!- .
onDelete""  
:""  !
ReferentialAction""" 3
.""3 4
Cascade""4 ;
)""; <
;""< =
}## 
)## 
;## 
migrationBuilder%% 
.%% 
CreateIndex%% (
(%%( )
name&& 
:&& 
$str&& 3
,&&3 4
table'' 
:'' 
$str'' '
,''' (
column(( 
:(( 
$str(( #
)((# $
;(($ %
})) 	
	protected++ 
override++ 
void++ 
Down++  $
(++$ %
MigrationBuilder++% 5
migrationBuilder++6 F
)++F G
{,, 	
migrationBuilder-- 
.-- 
	DropTable-- &
(--& '
name.. 
:.. 
$str.. &
)..& '
;..' (
migrationBuilder00 
.00 
CreateTable00 (
(00( )
name11 
:11 
$str11 $
,11$ %
columns22 
:22 
table22 
=>22 !
new22" %
{33 
OrdersId44 
=44 
table44 $
.44$ %
Column44% +
<44+ ,
int44, /
>44/ 0
(440 1
type441 5
:445 6
$str447 @
,44@ A
nullable44B J
:44J K
false44L Q
)44Q R
,44R S

ProductsId55 
=55  
table55! &
.55& '
Column55' -
<55- .
int55. 1
>551 2
(552 3
type553 7
:557 8
$str559 B
,55B C
nullable55D L
:55L M
false55N S
)55S T
}66 
,66 
constraints77 
:77 
table77 "
=>77# %
{88 
table99 
.99 

PrimaryKey99 $
(99$ %
$str99% 6
,996 7
x998 9
=>99: <
new99= @
{99A B
x99C D
.99D E
OrdersId99E M
,99M N
x99O P
.99P Q

ProductsId99Q [
}99\ ]
)99] ^
;99^ _
table:: 
.:: 

ForeignKey:: $
(::$ %
name;; 
:;; 
$str;; ?
,;;? @
column<< 
:<< 
x<<  !
=><<" $
x<<% &
.<<& '
OrdersId<<' /
,<</ 0
principalTable== &
:==& '
$str==( 0
,==0 1
principalColumn>> '
:>>' (
$str>>) -
,>>- .
onDelete??  
:??  !
ReferentialAction??" 3
.??3 4
Cascade??4 ;
)??; <
;??< =
table@@ 
.@@ 

ForeignKey@@ $
(@@$ %
nameAA 
:AA 
$strAA C
,AAC D
columnBB 
:BB 
xBB  !
=>BB" $
xBB% &
.BB& '

ProductsIdBB' 1
,BB1 2
principalTableCC &
:CC& '
$strCC( 2
,CC2 3
principalColumnDD '
:DD' (
$strDD) -
,DD- .
onDeleteEE  
:EE  !
ReferentialActionEE" 3
.EE3 4
CascadeEE4 ;
)EE; <
;EE< =
}FF 
)FF 
;FF 
migrationBuilderHH 
.HH 
CreateIndexHH (
(HH( )
nameII 
:II 
$strII 2
,II2 3
tableJJ 
:JJ 
$strJJ %
,JJ% &
columnKK 
:KK 
$strKK $
)KK$ %
;KK% &
}LL 	
}MM 
}NN ù
u/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201106125508_OrdersProductsMigration2.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class $
OrdersProductsMigration2 1
:2 3
	Migration4 =
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
}

 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ‡
n/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201106183230_ProductCategories.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
ProductCategories *
:+ ,
	Migration- 6
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
	AddColumn		 &
<		& '
int		' *
>		* +
(		+ ,
name

 
:

 
$str

  
,

  !
table 
: 
$str !
,! "
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue 
: 
$num 
)  
;  !
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str  
,  !
table 
: 
$str !
)! "
;" #
} 	
} 
} Ì4
v/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201108002934_NewOrderProductsMigration.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class %
NewOrderProductsMigration 2
:3 4
	Migration5 >
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 :
,

: ;
table 
: 
$str 
)  
;  !
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str .
,. /
table 
: 
$str 
)  
;  !
migrationBuilder 
. 
AlterColumn (
<( )
int) ,
>, -
(- .
name 
: 
$str 
, 
table 
: 
$str 
,  
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue 
: 
$num 
,  

oldClrType 
: 
typeof "
(" #
int# &
)& '
,' (
oldType 
: 
$str "
," #
oldNullable 
: 
true !
)! "
;" #
migrationBuilder 
. 
AlterColumn (
<( )
int) ,
>, -
(- .
name 
: 
$str $
,$ %
table 
: 
$str 
,  
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue   
:   
$num   
,    

oldClrType!! 
:!! 
typeof!! "
(!!" #
int!!# &
)!!& '
,!!' (
oldType"" 
:"" 
$str"" "
,""" #
oldNullable## 
:## 
true## !
)##! "
;##" #
migrationBuilder%% 
.%% 
AddForeignKey%% *
(%%* +
name&& 
:&& 
$str&& :
,&&: ;
table'' 
:'' 
$str'' 
,''  
column(( 
:(( 
$str(( &
,((& '
principalTable)) 
:)) 
$str))  -
,))- .
principalColumn** 
:**  
$str**! %
,**% &
onDelete++ 
:++ 
ReferentialAction++ +
.+++ ,
Cascade++, 3
)++3 4
;++4 5
migrationBuilder-- 
.-- 
AddForeignKey-- *
(--* +
name.. 
:.. 
$str.. .
,... /
table// 
:// 
$str// 
,//  
column00 
:00 
$str00  
,00  !
principalTable11 
:11 
$str11  '
,11' (
principalColumn22 
:22  
$str22! %
,22% &
onDelete33 
:33 
ReferentialAction33 +
.33+ ,
Cascade33, 3
)333 4
;334 5
}44 	
	protected66 
override66 
void66 
Down66  $
(66$ %
MigrationBuilder66% 5
migrationBuilder666 F
)66F G
{77 	
migrationBuilder88 
.88 
DropForeignKey88 +
(88+ ,
name99 
:99 
$str99 :
,99: ;
table:: 
::: 
$str:: 
)::  
;::  !
migrationBuilder<< 
.<< 
DropForeignKey<< +
(<<+ ,
name== 
:== 
$str== .
,==. /
table>> 
:>> 
$str>> 
)>>  
;>>  !
migrationBuilder@@ 
.@@ 
AlterColumn@@ (
<@@( )
int@@) ,
>@@, -
(@@- .
nameAA 
:AA 
$strAA 
,AA 
tableBB 
:BB 
$strBB 
,BB  
typeCC 
:CC 
$strCC 
,CC  
nullableDD 
:DD 
trueDD 
,DD 

oldClrTypeEE 
:EE 
typeofEE "
(EE" #
intEE# &
)EE& '
,EE' (
oldTypeFF 
:FF 
$strFF "
)FF" #
;FF# $
migrationBuilderHH 
.HH 
AlterColumnHH (
<HH( )
intHH) ,
>HH, -
(HH- .
nameII 
:II 
$strII $
,II$ %
tableJJ 
:JJ 
$strJJ 
,JJ  
typeKK 
:KK 
$strKK 
,KK  
nullableLL 
:LL 
trueLL 
,LL 

oldClrTypeMM 
:MM 
typeofMM "
(MM" #
intMM# &
)MM& '
,MM' (
oldTypeNN 
:NN 
$strNN "
)NN" #
;NN# $
migrationBuilderPP 
.PP 
AddForeignKeyPP *
(PP* +
nameQQ 
:QQ 
$strQQ :
,QQ: ;
tableRR 
:RR 
$strRR 
,RR  
columnSS 
:SS 
$strSS &
,SS& '
principalTableTT 
:TT 
$strTT  -
,TT- .
principalColumnUU 
:UU  
$strUU! %
,UU% &
onDeleteVV 
:VV 
ReferentialActionVV +
.VV+ ,
RestrictVV, 4
)VV4 5
;VV5 6
migrationBuilderXX 
.XX 
AddForeignKeyXX *
(XX* +
nameYY 
:YY 
$strYY .
,YY. /
tableZZ 
:ZZ 
$strZZ 
,ZZ  
column[[ 
:[[ 
$str[[  
,[[  !
principalTable\\ 
:\\ 
$str\\  '
,\\' (
principalColumn]] 
:]]  
$str]]! %
,]]% &
onDelete^^ 
:^^ 
ReferentialAction^^ +
.^^+ ,
Restrict^^, 4
)^^4 5
;^^5 6
}__ 	
}`` 
}aa Ÿ4
l/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201112140842_RebaseMigration.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
RebaseMigration (
:) *
	Migration+ 4
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 :
,

: ;
table 
: 
$str 
)  
;  !
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str .
,. /
table 
: 
$str 
)  
;  !
migrationBuilder 
. 
AlterColumn (
<( )
int) ,
>, -
(- .
name 
: 
$str 
, 
table 
: 
$str 
,  
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue 
: 
$num 
,  

oldClrType 
: 
typeof "
(" #
int# &
)& '
,' (
oldType 
: 
$str "
," #
oldNullable 
: 
true !
)! "
;" #
migrationBuilder 
. 
AlterColumn (
<( )
int) ,
>, -
(- .
name 
: 
$str $
,$ %
table 
: 
$str 
,  
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue   
:   
$num   
,    

oldClrType!! 
:!! 
typeof!! "
(!!" #
int!!# &
)!!& '
,!!' (
oldType"" 
:"" 
$str"" "
,""" #
oldNullable## 
:## 
true## !
)##! "
;##" #
migrationBuilder%% 
.%% 
AddForeignKey%% *
(%%* +
name&& 
:&& 
$str&& :
,&&: ;
table'' 
:'' 
$str'' 
,''  
column(( 
:(( 
$str(( &
,((& '
principalTable)) 
:)) 
$str))  -
,))- .
principalColumn** 
:**  
$str**! %
,**% &
onDelete++ 
:++ 
ReferentialAction++ +
.+++ ,
Cascade++, 3
)++3 4
;++4 5
migrationBuilder-- 
.-- 
AddForeignKey-- *
(--* +
name.. 
:.. 
$str.. .
,... /
table// 
:// 
$str// 
,//  
column00 
:00 
$str00  
,00  !
principalTable11 
:11 
$str11  '
,11' (
principalColumn22 
:22  
$str22! %
,22% &
onDelete33 
:33 
ReferentialAction33 +
.33+ ,
Cascade33, 3
)333 4
;334 5
}55 	
	protected77 
override77 
void77 
Down77  $
(77$ %
MigrationBuilder77% 5
migrationBuilder776 F
)77F G
{88 	
migrationBuilder99 
.99 
DropForeignKey99 +
(99+ ,
name:: 
::: 
$str:: :
,::: ;
table;; 
:;; 
$str;; 
);;  
;;;  !
migrationBuilder== 
.== 
DropForeignKey== +
(==+ ,
name>> 
:>> 
$str>> .
,>>. /
table?? 
:?? 
$str?? 
)??  
;??  !
migrationBuilderAA 
.AA 
AlterColumnAA (
<AA( )
intAA) ,
>AA, -
(AA- .
nameBB 
:BB 
$strBB 
,BB 
tableCC 
:CC 
$strCC 
,CC  
typeDD 
:DD 
$strDD 
,DD  
nullableEE 
:EE 
trueEE 
,EE 

oldClrTypeFF 
:FF 
typeofFF "
(FF" #
intFF# &
)FF& '
,FF' (
oldTypeGG 
:GG 
$strGG "
)GG" #
;GG# $
migrationBuilderII 
.II 
AlterColumnII (
<II( )
intII) ,
>II, -
(II- .
nameJJ 
:JJ 
$strJJ $
,JJ$ %
tableKK 
:KK 
$strKK 
,KK  
typeLL 
:LL 
$strLL 
,LL  
nullableMM 
:MM 
trueMM 
,MM 

oldClrTypeNN 
:NN 
typeofNN "
(NN" #
intNN# &
)NN& '
,NN' (
oldTypeOO 
:OO 
$strOO "
)OO" #
;OO# $
migrationBuilderQQ 
.QQ 
AddForeignKeyQQ *
(QQ* +
nameRR 
:RR 
$strRR :
,RR: ;
tableSS 
:SS 
$strSS 
,SS  
columnTT 
:TT 
$strTT &
,TT& '
principalTableUU 
:UU 
$strUU  -
,UU- .
principalColumnVV 
:VV  
$strVV! %
,VV% &
onDeleteWW 
:WW 
ReferentialActionWW +
.WW+ ,
RestrictWW, 4
)WW4 5
;WW5 6
migrationBuilderYY 
.YY 
AddForeignKeyYY *
(YY* +
nameZZ 
:ZZ 
$strZZ .
,ZZ. /
table[[ 
:[[ 
$str[[ 
,[[  
column\\ 
:\\ 
$str\\  
,\\  !
principalTable]] 
:]] 
$str]]  '
,]]' (
principalColumn^^ 
:^^  
$str^^! %
,^^% &
onDelete__ 
:__ 
ReferentialAction__ +
.__+ ,
Restrict__, 4
)__4 5
;__5 6
}`` 	
}aa 
}bb ç
m/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Migrations/20201112141446_RebaseMigration2.cs
	namespace 	
glovo_webapi
 
. 

Migrations !
{ 
public 

partial 
class 
RebaseMigration2 )
:* +
	Migration, 5
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
}

 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ì	
]/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Order/GetOrderModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Order #
{		 
public

 

class

 
GetOrderModel

 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
DateTime 
BuyDateTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
RestaurantId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
IEnumerable 
< 
OrderProductModel ,
>, -
Products. 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
} Î
^/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Order/PostOrderModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Order #
{ 
public 

class 
PostOrderModel 
{ 
public		 
DateTime		 
BuyDateTime		 #
{		$ %
get		& )
;		) *
set		+ .
;		. /
}		0 1
public 
int 
RestaurantId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
IEnumerable 
< 
OrderProductModel ,
>, -
Products. 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
} ñ
h/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/OrderProduct/OrderProductModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
OrderProduct *
{ 
public 

class 
OrderProductModel "
{ 
public 
int 
	ProductId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
} 
}		 æ
b/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Product/ProductReadModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Product %
{ 
public 
class 
ProductReadModel %
{ 	
public 
int 
Id 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
Name		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public 
string 
ImgPath %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
Description )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
float 
Price "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
RestaurantId '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
ProductCategory &
Category' /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
string 
CategoryString ,
{ 
get 
{ 
return $
Category% -
.- .
ToString. 6
(6 7
)7 8
;8 9
}: ;
} 
public 
ProductReadModel '
(' (
int( +
Id, .
,. /
string0 6
Name7 ;
,; <
string= C
ImgPathD K
,K L
stringM S
DescriptionT _
,_ `
floata f
Priceg l
,l m
intn q
RestaurantIdr ~
)~ 
{ 
this 
. 
Id 
=  !
Id" $
;$ %
this 
. 
Name !
=" #
Name$ (
;( )
this 
. 
ImgPath $
=% &
ImgPath' .
;. /
this 
. 
Description (
=) *
Description+ 6
;6 7
this   
.   
Price   "
=  # $
Price  % *
;  * +
this!! 
.!! 
RestaurantId!! )
=!!* +
RestaurantId!!, 8
;!!8 9
}"" 
}$$ 	
}%% ”

h/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Restaurant/RestaurantReadModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 

Restaurant (
{ 
public 
class 
RestaurantReadModel (
{ 	
public 
int 
Id 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Name "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
string		 
ImgPath		 %
{		& '
get		( +
;		+ ,
set		- 0
;		0 1
}		2 3
public 
RestaurantReadModel *
(* +
int+ .
Id/ 1
,1 2
string3 9
Name: >
,> ?
string@ F
ImgPathG N
)N O
{ 
this 
. 
Id 
=  !
Id" $
;$ %
this 
. 
Name !
=" #
Name$ (
;( )
this 
. 
ImgPath $
=% &
ImgPath' .
;. /
} 
} 	
} ‰
Z/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Users/LoginModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Users #
{ 
public 

class 

LoginModel 
{ 
[ 	
Required	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[		 	
Required			 
]		 
public

 
string

 
Password

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
} 
} ∂
]/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Users/RegisterModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Users #
{ 
public 

class 
RegisterModel 
{ 
[ 	
Required	 
] 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[		 	
Required			 
]		 
public

 
string

 
Email

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
[ 	
Required	 
] 
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} û
_/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Users/UpdateUserModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Users #
{ 
public 

class 
UpdateUserModel  
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
}		 
}

 £

Y/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Models/Users/UserModel.cs
	namespace 	
glovo_webapi
 
. 
Models 
. 
Users #
{ 
public 

class 
	UserModel 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public

 
	UserModel

 
(

 
int

 
Id

 
,

  
string

! '
Email

( -
,

- .
string

/ 5
Name

6 :
)

: ;
{ 	
this 
. 
Id 
= 
Id 
; 
this 
. 
Email 
= 
Email 
; 
this 
. 
Name 
= 
Name 
; 
} 	
} 
} ú
]/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Profiles/AutoMapperProfile.cs
	namespace 	
glovo_webapi
 
. 
Profiles 
{ 
public 

class 
AutoMapperProfile "
:# $
Profile% ,
{ 
public		 
AutoMapperProfile		  
(		  !
)		! "
{

 	
	CreateMap 
< 
User 
, 
	UserModel %
>% &
(& '
)' (
;( )
	CreateMap 
< 
RegisterModel #
,# $
User% )
>) *
(* +
)+ ,
;, -
	CreateMap 
< 
UpdateUserModel %
,% &
User' +
>+ ,
(, -
)- .
;. /
} 	
} 
} §
a/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Profiles/OrdersProductsProfile.cs
	namespace 	
glovo_webapi
 
. 
Profiles 
{ 
public 

class !
OrdersProductsProfile &
:' (
Profile) 0
{ 
public		 !
OrdersProductsProfile		 $
(		$ %
)		% &
{

 	
	CreateMap 
< 
OrderProduct "
," #
OrderProductModel$ 5
>5 6
(6 7
)7 8
;8 9
	CreateMap 
< 
OrderProductModel '
,' (
OrderProduct) 5
>5 6
(6 7
)7 8
;8 9
} 	
} 
} £
Y/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Profiles/OrdersProfile.cs
	namespace 	
glovo_webapi
 
. 
Profiles 
{ 
public 

class 
OrdersProfile 
:  
Profile! (
{		 
public

 
OrdersProfile

 
(

 
)

 
{ 	
	CreateMap 
< 
Order 
, 
GetOrderModel *
>* +
(+ ,
), -
. 
	ForMember 
( 
getOrderModel (
=>) +
getOrderModel, 9
.9 :
Products: B
,B C
opts 
=> 
opts  
.  !
MapFrom! (
(( )
order) .
=>/ 1
order2 7
.7 8
OrdersProducts8 F
)F G
)G H
;H I
	CreateMap 
< 
PostOrderModel $
,$ %
Order& +
>+ ,
(, -
)- .
. 
	ForMember 
( 
order  
=>! #
order$ )
.) *
OrdersProducts* 8
,8 9
opts 
=> 
opts  
.  !
MapFrom! (
(( )
postOrderModel) 7
=>8 :
postOrderModel; I
.I J
ProductsJ R
)R S
)S T
;T U
} 	
} 
} ‚
[/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Profiles/ProductsProfile.cs
	namespace 	
glovo_webapi
 
. 
Profiles 
{ 
public 

class 
ProductsProfile  
:! "
Profile# *
{ 
public		 
ProductsProfile		 
(		 
)		  
{

 	
	CreateMap 
< 
Product 
, 
ProductReadModel /
>/ 0
(0 1
)1 2
;2 3
} 	
} 
} Ò
^/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Profiles/RestaurantsProfile.cs
	namespace 	
glovo_webapi
 
. 
Profiles 
{ 
public 

class 
RestaurantsProfile #
:$ %
Profile& -
{ 
public		 
RestaurantsProfile		 !
(		! "
)		" #
{

 	
	CreateMap 
< 

Restaurant  
,  !
RestaurantReadModel" 5
>5 6
(6 7
)7 8
;8 9
} 	
} 
} §

J/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Program.cs
	namespace

 	
glovo_webapi


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{8 9

webBuilder: D
.D E

UseStartupE O
<O P
StartupP W
>W X
(X Y
)Y Z
;Z [
}\ ]
)] ^
;^ _
} 
} Ê
V/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Exceptions.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
UserService  +
{ 
static 

class 
UserExceptionCodes #
{ 
public 
static 
int 
InvalidCredentials ,
=- .
$num/ 0
;0 1
public 
static 
int 
UserNotFound &
=' (
$num) *
;* +
public		 
static		 
int		 
BadPassword		 %
=		& '
$num		( )
;		) *
public

 
static

 
int

 
UserAlreadyExists

 +
=

, -
$num

. /
;

/ 0
} 
static 

class 
OrderExceptionCodes $
{ 
public 
static 
int 
InvalidUser %
=& '
$num( )
;) *
public 
static 
int 
RestaurantNotFound ,
=- .
$num/ 0
;0 1
public 
static 
int 
ProductNotFound )
=* +
$num, -
;- .
public 
static 
int 
BadOrderProduct )
=* +
$num, -
;- .
} 
} ﬁ
a/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Orders/IOrdersService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
Orders  &
{ 
public 

	interface 
IOrdersService #
{ 
IEnumerable 
< 
Order 
> 
GetAllOrders '
(' (
)( )
;) *
Order		 
GetOrderById		 
(		 
int		 
orderId		 &
)		& '
;		' (
Order

 
AddOrder

 
(

 
Order

 
order

 "
)

" #
;

# $
IEnumerable 
< 
Order 
> 
GetAllOrdersOfUser -
(- .
int. 1
userId2 8
)8 9
;9 :
Order 
GetOrderOfUserById  
(  !
int! $
userId% +
,+ ,
int- 0
orderId1 8
)8 9
;9 :
IEnumerable 
< 
Order 
> $
GetAllOrdersOfRestaurant 3
(3 4
int4 7
restId8 >
)> ?
;? @
Order $
GetOrderOfRestaurantById &
(& '
int' *
restId+ 1
,1 2
int3 6
orderId7 >
)> ?
;? @
} 
} ÌN
f/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Orders/NpgsqlOrdersService.cs
	namespace

 	
glovo_webapi


 
.

 
Services

 
.

  
Orders

  &
{ 
public 

class 
NpgsqlOrdersService $
:% &
IOrdersService' 5
{ 
private 
readonly 
GlovoDbContext '
_context( 0
;0 1
private 
readonly  
IHttpContextAccessor - 
_httpContextAccessor. B
;B C
public 
NpgsqlOrdersService "
(" #
GlovoDbContext# 1
context2 9
,9 : 
IHttpContextAccessor; O
httpContextAccessorP c
)c d
{ 	
_context 
= 
context 
;  
_httpContextAccessor  
=! "
httpContextAccessor# 6
;6 7
} 	
public 
IEnumerable 
< 
Order  
>  !
GetAllOrders" .
(. /
)/ 0
{ 	
return 
_context 
. 
Orders "
. 
Include 
( 
order 
=> !
order" '
.' (

Restaurant( 2
)2 3
. 
Include 
( 
order 
=> !
order" '
.' (
User( ,
), -
. 
Include 
( 
order 
=> !
order" '
.' (
OrdersProducts( 6
)6 7
. 
ToList 
( 
) 
; 
} 	
public   
Order   
GetOrderById   !
(  ! "
int  " %
orderId  & -
)  - .
{!! 	
return"" 
_context"" 
."" 
Orders"" "
.## 
Include## 
(## 
order## 
=>## !
order##" '
.##' (

Restaurant##( 2
)##2 3
.$$ 
Include$$ 
($$ 
order$$ 
=>$$ !
order$$" '
.$$' (
User$$( ,
)$$, -
.%% 
Include%% 
(%% 
order%% 
=>%% !
order%%" '
.%%' (
OrdersProducts%%( 6
)%%6 7
.&& 
FirstOrDefault&& 
(&&  
o&&  !
=>&&" $
o&&% &
.&&& '
Id&&' )
==&&* ,
orderId&&- 4
)&&4 5
;&&5 6
}'' 	
public)) 
Order)) 
AddOrder)) 
()) 
Order)) #
order))$ )
)))) *
{** 	

Restaurant,, 
orderRestaurant,, &
=,,' (
(,,) *

Restaurant,,* 4
),,4 5
_context,,6 >
.,,> ?
Restaurants,,? J
.,,J K
FirstOrDefault,,K Y
(,,Y Z
r,,Z [
=>,,\ ^
r,,_ `
.,,` a
Id,,a c
==,,d f
order,,g l
.,,l m
RestaurantId,,m y
),,y z
;,,z {
if-- 
(-- 
orderRestaurant-- 
==--  "
null--# '
)--' (
{--) *
throw--+ 0
new--1 4
RequestException--5 E
(--E F
OrderExceptionCodes--F Y
.--Y Z
RestaurantNotFound--Z l
)--l m
;--m n
}--o p
foreach00 
(00 
OrderProduct00 !
orderProduct00" .
in00/ 1
order002 7
.007 8
OrdersProducts008 F
)00F G
{00H I
if11 
(11 
orderProduct11 
==11  "
null11# '
)11' (
{11) *
throw11* /
new110 3
RequestException114 D
(11D E
OrderExceptionCodes11E X
.11X Y
BadOrderProduct11Y h
)11h i
;11i j
}11j k
Product22 
product22 
=22  !
_context22" *
.22* +
Products22+ 3
.223 4
FirstOrDefault224 B
(22B C
p22C D
=>22E G
p22H I
.22I J
Id22J L
==22M O
orderProduct22P \
.22\ ]
	ProductId22] f
)22f g
;22g h
if33 
(33 
product33 
==33 
null33 #
)33# $
{33% &
throw33& +
new33, /
RequestException330 @
(33@ A
OrderExceptionCodes33A T
.33T U
ProductNotFound33U d
)33d e
;33e f
}33f g
}44 
User77 

loggedUser77 
=77 
(77 
User77 #
)77# $ 
_httpContextAccessor77% 9
.779 :
HttpContext77: E
.77E F
Items77F K
[77K L
$str77L R
]77R S
;77S T
order88 
.88 
UserId88 
=88 

loggedUser88 %
.88% &
Id88& (
;88( )
order;; 
.;; 
Id;; 
=;; 
$num;; 
;;; 
_context<< 
.<< 
Orders<< 
.<< 
Add<< 
(<<  
order<<  %
)<<% &
;<<& '
_context== 
.== 
SaveChanges==  
(==  !
)==! "
;==" #
return?? 
order?? 
;?? 
}@@ 	
publicBB 
IEnumerableBB 
<BB 
OrderBB  
>BB  !
GetAllOrdersOfUserBB" 4
(BB4 5
intBB5 8
userIdBB9 ?
)BB? @
{CC 	
returnDD 
_contextDD 
.DD 
OrdersDD "
.EE 
IncludeEE 
(EE 
orderEE 
=>EE !
orderEE" '
.EE' (

RestaurantEE( 2
)EE2 3
.FF 
IncludeFF 
(FF 
orderFF 
=>FF !
orderFF" '
.FF' (
UserFF( ,
)FF, -
.GG 
IncludeGG 
(GG 
orderGG 
=>GG !
orderGG" '
.GG' (
OrdersProductsGG( 6
)GG6 7
.HH 
WhereHH 
(HH 
oHH 
=>HH 
oHH 
.HH 
UserHH "
.HH" #
IdHH# %
==HH& (
userIdHH) /
)HH/ 0
.HH0 1
ToListHH1 7
(HH7 8
)HH8 9
;HH9 :
}II 	
publicKK 
OrderKK 
GetOrderOfUserByIdKK '
(KK' (
intKK( +
userIdKK, 2
,KK2 3
intKK4 7
orderIdKK8 ?
)KK? @
{LL 	
returnMM 
_contextMM 
.MM 
OrdersMM "
.NN 
IncludeNN 
(NN 
orderNN 
=>NN !
orderNN" '
.NN' (

RestaurantNN( 2
)NN2 3
.OO 
IncludeOO 
(OO 
orderOO 
=>OO !
orderOO" '
.OO' (
UserOO( ,
)OO, -
.PP 
IncludePP 
(PP 
orderPP 
=>PP !
orderPP" '
.PP' (
OrdersProductsPP( 6
)PP6 7
.QQ 
FirstOrDefaultQQ 
(QQ  
oQQ  !
=>QQ" $
oQQ% &
.QQ& '
UserQQ' +
.QQ+ ,
IdQQ, .
==QQ/ 1
userIdQQ2 8
&&QQ9 ;
oQQ< =
.QQ= >
IdQQ> @
==QQA C
orderIdQQD K
)QQK L
;QQL M
}RR 	
publicTT 
IEnumerableTT 
<TT 
OrderTT  
>TT  !$
GetAllOrdersOfRestaurantTT" :
(TT: ;
intTT; >
restIdTT? E
)TTE F
{UU 	
returnVV 
_contextVV 
.VV 
OrdersVV "
.WW 
IncludeWW 
(WW 
orderWW 
=>WW !
orderWW" '
.WW' (

RestaurantWW( 2
)WW2 3
.XX 
IncludeXX 
(XX 
orderXX 
=>XX !
orderXX" '
.XX' (
UserXX( ,
)XX, -
.YY 
IncludeYY 
(YY 
orderYY 
=>YY !
orderYY" '
.YY' (
OrdersProductsYY( 6
)YY6 7
.ZZ 
WhereZZ 
(ZZ 
oZZ 
=>ZZ 
oZZ 
.ZZ 

RestaurantZZ (
.ZZ( )
IdZZ) +
==ZZ, .
restIdZZ/ 5
)ZZ5 6
.ZZ6 7
ToListZZ7 =
(ZZ= >
)ZZ> ?
;ZZ? @
}[[ 	
public]] 
Order]] $
GetOrderOfRestaurantById]] -
(]]- .
int]]. 1
restId]]2 8
,]]8 9
int]]: =
orderId]]> E
)]]E F
{^^ 	
return__ 
_context__ 
.__ 
Orders__ "
.`` 
Include`` 
(`` 
order`` 
=>`` !
order``" '
.``' (

Restaurant``( 2
)``2 3
.aa 
Includeaa 
(aa 
orderaa 
=>aa !
orderaa" '
.aa' (
Useraa( ,
)aa, -
.bb 
Includebb 
(bb 
orderbb 
=>bb !
orderbb" '
.bb' (
OrdersProductsbb( 6
)bb6 7
.cc 
FirstOrDefaultcc 
(cc  
occ  !
=>cc" $
occ% &
.cc& '

Restaurantcc' 1
.cc1 2
Idcc2 4
==cc5 7
restIdcc8 >
&&cc? A
occB C
.ccC D
IdccD F
==ccG I
orderIdccJ Q
)ccQ R
;ccR S
}dd 	
}ee 
}ff —
e/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Products/IProductsService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
Products  (
{ 
public 

	interface 
IProductsService %
{ 
IEnumerable		 
<		 
Product		 
>		 
GetAllProducts		 +
(		+ ,
)		, -
;		- .
IEnumerable

 
<

 
Product

 
>

 !
GetProductsByCategory

 2
(

2 3
ProductCategory

3 B
c

C D
)

D E
;

E F
Product 
GetProductById 
( 
int "
id# %
)% &
;& '
IEnumerable 
< 
Product 
> &
GetAllProductsOfRestaurant 7
(7 8
int8 ;
idRest< B
)B C
;C D
IEnumerable 
< 
Product 
> 0
$GetAllProductsOfRestaurantByCategory A
(A B
intB E
idRestF L
,L M
ProductCategoryN ]
c^ _
)_ `
;` a
Product &
GetProductOfRestaurantById *
(* +
int+ .
idRest/ 5
,5 6
int7 :
idProd; A
)A B
;B C
} 
} Á3
h/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Products/MockProductsService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
Products  (
{ 
public 

class 
MockProductsService $
:% &
IProductsService' 7
{ 
private		 

Restaurant		 
rest1		  
;		  !
private

 

Restaurant

 
rest2

  
;

  !
private 

Restaurant 
rest3  
;  !
public 
MockProductsService "
(" #
)# $
{ 	
rest1 
= 
new 

Restaurant "
(" #
$num# $
,$ %
$str& 4
,4 5
$str6 8
)8 9
;9 :
rest2 
= 
new 

Restaurant "
(" #
$num# $
,$ %
$str& 4
,4 5
$str6 8
)8 9
;9 :
rest3 
= 
new 

Restaurant "
(" #
$num# $
,$ %
$str& 4
,4 5
$str6 8
)8 9
;9 :
} 	
public 
IEnumerable 
< 
Product "
>" #
GetAllProducts$ 2
(2 3
)3 4
{ 	
return 
new 
List 
< 
Product #
># $
{ 
new 
Product 
( 
$num 
, 
$str 3
,3 4
$str5 O
,O P
$strQ |
,| }
$num	~ É
,
É Ñ
$num
Ö Ü
)
Ü á
,
á à
new 
Product 
( 
$num 
, 
$str 5
,5 6
$str7 Q
,Q R
$strS ~
,~ 
$num
Ä Ö
,
Ö Ü
$num
á à
)
à â
,
â ä
new 
Product 
( 
$num 
, 
$str 5
,5 6
$str7 Q
,Q R
$strS ~
,~ 
$num
Ä Ö
,
Ö Ü
$num
á à
)
à â
,
â ä
new 
Product 
( 
$num 
, 
$str 5
,5 6
$str7 Q
,Q R
$strS ~
,~ 
$num
Ä Ö
,
Ö Ü
$num
á à
)
à â
,
â ä
new 
Product 
( 
$num 
, 
$str 3
,3 4
$str5 O
,O P
$strQ |
,| }
$num	~ É
,
É Ñ
$num
Ö Ü
)
Ü á
} 
; 
} 	
public 
IEnumerable 
< 
Product "
>" #!
GetProductsByCategory$ 9
(9 :
ProductCategory: I
cJ K
)K L
{   	
throw!! 
new!! 
System!! 
.!! #
NotImplementedException!! 4
(!!4 5
)!!5 6
;!!6 7
}"" 	
public$$ 
Product$$ 
GetProductById$$ %
($$% &
int$$& )
id$$* ,
)$$, -
{%% 	
return&& 
new&& 
Product&& 
(&& 
id&& !
,&&! "
$str&&# 1
,&&1 2
$str&&3 L
,&&L M
$str&&N y
,&&y z
$num	&&{ Ä
,
&&Ä Å
$num
&&Ç É
)
&&É Ñ
;
&&Ñ Ö
}'' 	
public)) 
IEnumerable)) 
<)) 
Product)) "
>))" #&
GetAllProductsOfRestaurant))$ >
())> ?
int))? B
idRest))C I
)))I J
{** 	
return++ 
new++ 
List++ 
<++ 
Product++ #
>++# $
{,, 
new-- 
Product-- 
(-- 
$num-- 
,-- 
$str-- 3
,--3 4
$str--5 O
,--O P
$str--Q |
,--| }
$num	--~ É
,
--É Ñ
idRest
--Ö ã
)
--ã å
,
--å ç
new.. 
Product.. 
(.. 
$num.. 
,.. 
$str.. 5
,..5 6
$str..7 Q
,..Q R
$str..S ~
,..~ 
$num
..Ä Ö
,
..Ö Ü
idRest
..á ç
)
..ç é
,
..é è
new// 
Product// 
(// 
$num// 
,// 
$str// 5
,//5 6
$str//7 Q
,//Q R
$str//S ~
,//~ 
$num
//Ä Ö
,
//Ö Ü
idRest
//á ç
)
//ç é
,
//é è
new00 
Product00 
(00 
$num00 
,00 
$str00 5
,005 6
$str007 Q
,00Q R
$str00S ~
,00~ 
$num
00Ä Ö
,
00Ö Ü
idRest
00á ç
)
00ç é
,
00é è
new11 
Product11 
(11 
$num11 
,11 
$str11 3
,113 4
$str115 O
,11O P
$str11Q |
,11| }
$num	11~ É
,
11É Ñ
idRest
11Ö ã
)
11ã å
}22 
;22 
}33 	
public55 
IEnumerable55 
<55 
Product55 "
>55" #0
$GetAllProductsOfRestaurantByCategory55$ H
(55H I
int55I L
idRest55M S
,55S T
ProductCategory55U d
c55e f
)55f g
{66 	
throw77 
new77 
System77 
.77 #
NotImplementedException77 4
(774 5
)775 6
;776 7
}88 	
public:: 
Product:: &
GetProductOfRestaurantById:: 1
(::1 2
int::2 5
idRest::6 <
,::< =
int::> A
idProd::B H
)::H I
{;; 	
return<< 
new<< 
Product<< 
(<< 
idProd<< %
,<<% &
$str<<' ;
,<<; <
$str<<= W
,<<W X
$str== ;
,==; <
$num=== B
,==B C
idRest==D J
)==J K
;==K L
}>> 	
}?? 
}@@ ÷,
j/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Products/NpgsqlProductsService.cs
	namespace 	
glovo_webapi 
. 
Services  
.  !
Products! )
{		 
public

 

class

 !
NpgsqlProductsService

 &
:

' (
IProductsService

) 9
{ 
private 
readonly 
GlovoDbContext '
_context( 0
;0 1
public !
NpgsqlProductsService $
($ %
GlovoDbContext% 3
context4 ;
); <
{ 	
_context 
= 
context 
; 
} 	
public 
IEnumerable 
< 
Product "
>" #
GetAllProducts$ 2
(2 3
)3 4
{ 	
return 
_context 
. 
Products $
.$ %
ToList% +
(+ ,
), -
;- .
} 	
public 
IEnumerable 
< 
Product "
>" #!
GetProductsByCategory$ 9
(9 :
ProductCategory: I
cJ K
)K L
{ 	
if 
( 
c 
== 
ProductCategory $
.$ %
Uncategorized% 2
)2 3
{ 
return 
_context 
.  
Products  (
.( )
ToList) /
(/ 0
)0 1
;1 2
} 
return 
_context 
. 
Products $
.$ %
Where% *
(* +
p+ ,
=>- /
p0 1
.1 2
Category2 :
==; =
c> ?
)? @
;@ A
} 	
public!! 
Product!! 
GetProductById!! %
(!!% &
int!!& )
id!!* ,
)!!, -
{"" 	
return## 
_context## 
.## 
Products## $
.##$ %
FirstOrDefault##% 3
(##3 4
p##4 5
=>##6 8
p##9 :
.##: ;
Id##; =
==##> @
id##A C
)##C D
;##D E
}$$ 	
public&& 
IEnumerable&& 
<&& 
Product&& "
>&&" #&
GetAllProductsOfRestaurant&&$ >
(&&> ?
int&&? B
idRest&&C I
)&&I J
{'' 	

Restaurant(( 
r(( 
=(( 
_context(( #
.((# $
Restaurants(($ /
.((/ 0
SingleOrDefault((0 ?
(((? @
p((@ A
=>((B D
p((E F
.((F G
Id((G I
==((J L
idRest((M S
)((S T
;((T U
if)) 
()) 
r)) 
==)) 
null)) 
))) 
{** 
return++ 
null++ 
;++ 
},, 
return-- 
_context-- 
.-- 
Products-- $
.--$ %
Where--% *
(--* +
p--+ ,
=>--- /
p--0 1
.--1 2
RestaurantId--2 >
==--? A
idRest--B H
)--H I
;--I J
}.. 	
public00 
IEnumerable00 
<00 
Product00 "
>00" #0
$GetAllProductsOfRestaurantByCategory00$ H
(00H I
int00I L
idRest00M S
,00S T
ProductCategory00U d
c00e f
)00f g
{11 	

Restaurant22 
r22 
=22 
_context22 #
.22# $
Restaurants22$ /
.22/ 0
SingleOrDefault220 ?
(22? @
p22@ A
=>22B D
p22E F
.22F G
Id22G I
==22J L
idRest22M S
)22S T
;22T U
if33 
(33 
r33 
==33 
null33 
)33 
{44 
return55 
null55 
;55 
}66 
if77 
(77 
c77 
==77 
ProductCategory77 $
.77$ %
Uncategorized77% 2
)772 3
{88 
return99 
_context99 
.99  
Products99  (
.99( )
Where99) .
(99. /
p99/ 0
=>991 3
p994 5
.995 6
RestaurantId996 B
==99C E
idRest99F L
)99L M
;99M N
}:: 
return;; 
_context;; 
.;; 
Products;; $
.;;$ %
Where;;% *
(;;* +
p;;+ ,
=>;;- /
p;;0 1
.;;1 2
RestaurantId;;2 >
==;;? A
idRest;;B H
&&;;I K
p;;L M
.;;M N
Category;;N V
==;;W Y
c;;Z [
);;[ \
;;;\ ]
}<< 	
public>> 
Product>> &
GetProductOfRestaurantById>> 1
(>>1 2
int>>2 5
idRest>>6 <
,>>< =
int>>> A
idProd>>B H
)>>H I
{?? 	
return@@ 
_context@@ 
.@@ 
Products@@ $
.@@$ %
Where@@% *
(@@* +
p@@+ ,
=>@@- /
p@@0 1
.@@1 2
RestaurantId@@2 >
==@@? A
idRest@@B H
)@@H I
.@@I J
FirstOrDefault@@J X
(@@X Y
p@@Y Z
=>@@[ ]
p@@^ _
.@@_ `
Id@@` b
==@@c e
idProd@@f l
)@@l m
;@@m n
}AA 	
}BB 
}CC Ó
\/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/RequestException.cs
	namespace 	
glovo_webapi
 
. 
Services 
{ 
public 

class 
RequestException !
:" #
	Exception$ -
{ 
public 
int 
Code 
{ 
get 
; 
}  
public		 
RequestException		 
(		  
int		  #
code		$ (
)		( )
:		* +
base		, 0
(		0 1
$str		1 3
)		3 4
{

 	
Code 
= 
code 
; 
} 	
} 
} ç
k/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Restaurants/IRestaurantsService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
Restaurants  +
{ 
public 

	interface 
IRestaurantsService (
{ 
IEnumerable 
< 

Restaurant 
> 
GetAllRestaurants  1
(1 2
)2 3
;3 4

Restaurant		 
GetRestaurantById		 $
(		$ %
int		% (
id		) +
)		+ ,
;		, -
}

 
}  
n/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Restaurants/MockRestaurantsService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
Restaurants  +
{ 
public 

class "
MockRestaurantsService '
:( )
IRestaurantsService* =
{ 
public 
IEnumerable 
< 

Restaurant %
>% &
GetAllRestaurants' 8
(8 9
)9 :
{		 	
return

 
new

 
List

 
<

 

Restaurant

 &
>

& '
{ 
new 

Restaurant 
( 
$num  
,  !
$str" :
,: ;
$str< U
)U V
,V W
new 

Restaurant 
( 
$num  
,  !
$str" /
,/ 0
$str1 I
)I J
,J K
new 

Restaurant 
( 
$num  
,  !
$str" 7
,7 8
$str9 Q
)Q R
} 
; 
} 	
public 

Restaurant 
GetRestaurantById +
(+ ,
int, /
id0 2
)2 3
{ 	
return 
new 

Restaurant !
(! "
id" $
,$ %
$str& ?
,? @
$strA Z
)Z [
;[ \
} 	
} 
} û
p/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/Restaurants/NpgsqlRestaurantsService.cs
	namespace 	
glovo_webapi 
. 
Services  
.  !
Restaurants! ,
{ 
public 

class $
NpgsqlRestaurantsService )
:* +
IRestaurantsService, ?
{		 
private

 
readonly

 
GlovoDbContext

 '
_context

( 0
;

0 1
public $
NpgsqlRestaurantsService '
(' (
GlovoDbContext( 6
context7 >
)> ?
{ 	
_context 
= 
context 
; 
} 	
public 
IEnumerable 
< 

Restaurant %
>% &
GetAllRestaurants' 8
(8 9
)9 :
{ 	
return 
_context 
. 
Restaurants '
.' (
ToList( .
(. /
)/ 0
;0 1
} 	
public 

Restaurant 
GetRestaurantById +
(+ ,
int, /
id0 2
)2 3
{ 	
return 
_context 
. 
Restaurants '
.' (
FirstOrDefault( 6
(6 7
r7 8
=>9 ;
r< =
.= >
Id> @
==A C
idD F
)F G
;G H
} 	
} 
} ˇw
c/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Services/UserService/UserService.cs
	namespace 	
glovo_webapi
 
. 
Services 
.  
UserService  +
{ 
public

 

	interface

 
IUserService

 !
{ 
User 
Authenticate 
( 
string  
email! &
,& '
string( .
password/ 7
)7 8
;8 9
IEnumerable 
< 
User 
> 
GetAll  
(  !
)! "
;" #
User 
GetById 
( 
int 
id 
) 
; 
User 
Create 
( 
User 
user 
, 
string %
password& .
). /
;/ 0
void 
Update 
( 
User 
user 
, 
string %
password& .
=/ 0
null1 5
)5 6
;6 7
void 
Delete 
( 
int 
id 
) 
; 
} 
public 

class 
UserService 
: 
IUserService +
{ 
private 
GlovoDbContext 
_context '
;' (
public 
UserService 
( 
GlovoDbContext )
context* 1
)1 2
{ 	
_context 
= 
context 
; 
} 	
public 
User 
Authenticate  
(  !
string! '
email( -
,- .
string/ 5
password6 >
)> ?
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
email% *
)* +
||, .
string/ 5
.5 6
IsNullOrEmpty6 C
(C D
passwordD L
)L M
)M N
throw   
new   
RequestException   *
(  * +
UserExceptionCodes  + =
.  = >
InvalidCredentials  > P
)  P Q
;  Q R
var"" 
user"" 
="" 
_context"" 
.""  
Users""  %
.""% &
SingleOrDefault""& 5
(""5 6
x""6 7
=>""8 :
x""; <
.""< =
Email""= B
==""C E
email""F K
)""K L
;""L M
if%% 
(%% 
user%% 
==%% 
null%% 
)%% 
throw&& 
new&& 
RequestException&& *
(&&* +
UserExceptionCodes&&+ =
.&&= >
InvalidCredentials&&> P
)&&P Q
;&&Q R
if)) 
()) 
!)) 
VerifyPasswordHash)) #
())# $
password))$ ,
,)), -
user)). 2
.))2 3
PasswordHash))3 ?
,))? @
user))A E
.))E F
PasswordSalt))F R
)))R S
)))S T
throw** 
new** 
RequestException** *
(*** +
UserExceptionCodes**+ =
.**= >
InvalidCredentials**> P
)**P Q
;**Q R
return-- 
user-- 
;-- 
}.. 	
public00 
IEnumerable00 
<00 
User00 
>00  
GetAll00! '
(00' (
)00( )
{11 	
return22 
_context22 
.22 
Users22 !
;22! "
}33 	
public55 
User55 
GetById55 
(55 
int55 
id55  "
)55" #
{66 	
User77 
u77 
=77 
_context77 
.77 
Users77 #
.77# $
Find77$ (
(77( )
id77) +
)77+ ,
;77, -
if88 
(88 
u88 
==88 
null88 
)88 
{99 
throw:: 
new:: 
RequestException:: *
(::* +
UserExceptionCodes::+ =
.::= >
UserNotFound::> J
)::J K
;::K L
};; 
return<< 
u<< 
;<< 
}== 	
public?? 
User?? 
Create?? 
(?? 
User?? 
user??  $
,??$ %
string??& ,
password??- 5
)??5 6
{@@ 	
ifBB 
(BB 
stringBB 
.BB 
IsNullOrWhiteSpaceBB )
(BB) *
passwordBB* 2
)BB2 3
)BB3 4
throwCC 
newCC 
RequestExceptionCC *
(CC* +
UserExceptionCodesCC+ =
.CC= >
BadPasswordCC> I
)CCI J
;CCJ K
ifEE 
(EE 
_contextEE 
.EE 
UsersEE 
.EE 
AnyEE "
(EE" #
xEE# $
=>EE% '
xEE( )
.EE) *
EmailEE* /
==EE0 2
userEE3 7
.EE7 8
EmailEE8 =
)EE= >
)EE> ?
throwFF 
newFF 
RequestExceptionFF *
(FF* +
UserExceptionCodesFF+ =
.FF= >
UserAlreadyExistsFF> O
)FFO P
;FFP Q
byteHH 
[HH 
]HH 
passwordHashHH 
,HH  
passwordSaltHH! -
;HH- .
CreatePasswordHashII 
(II 
passwordII '
,II' (
outII) ,
passwordHashII- 9
,II9 :
outII; >
passwordSaltII? K
)IIK L
;IIL M
userKK 
.KK 
PasswordHashKK 
=KK 
passwordHashKK  ,
;KK, -
userLL 
.LL 
PasswordSaltLL 
=LL 
passwordSaltLL  ,
;LL, -
_contextMM 
.MM 
UsersMM 
.MM 
AddMM 
(MM 
userMM #
)MM# $
;MM$ %
_contextNN 
.NN 
SaveChangesNN  
(NN  !
)NN! "
;NN" #
returnPP 
userPP 
;PP 
}QQ 	
publicSS 
voidSS 
UpdateSS 
(SS 
UserSS 
	userParamSS  )
,SS) *
stringSS+ 1
passwordSS2 :
=SS; <
nullSS= A
)SSA B
{TT 	
varUU 
userUU 
=UU 
_contextUU 
.UU  
UsersUU  %
.UU% &
FindUU& *
(UU* +
	userParamUU+ 4
.UU4 5
IdUU5 7
)UU7 8
;UU8 9
ifWW 
(WW 
userWW 
==WW 
nullWW 
)WW 
throwXX 
newXX 
RequestExceptionXX *
(XX* +
UserExceptionCodesXX+ =
.XX= >
UserNotFoundXX> J
)XXJ K
;XXK L
if[[ 
([[ 
![[ 
string[[ 
.[[ 
IsNullOrWhiteSpace[[ *
([[* +
	userParam[[+ 4
.[[4 5
Email[[5 :
)[[: ;
&&[[< >
	userParam[[? H
.[[H I
Email[[I N
!=[[O Q
user[[R V
.[[V W
Email[[W \
)[[\ ]
{\\ 
if^^ 
(^^ 
_context^^ 
.^^ 
Users^^ "
.^^" #
Any^^# &
(^^& '
x^^' (
=>^^) +
x^^, -
.^^- .
Email^^. 3
==^^4 6
	userParam^^7 @
.^^@ A
Email^^A F
)^^F G
)^^G H
throw__ 
new__ 
RequestException__ .
(__. /
UserExceptionCodes__/ A
.__A B
UserAlreadyExists__B S
)__S T
;__T U
useraa 
.aa 
Emailaa 
=aa 
	userParamaa &
.aa& '
Emailaa' ,
;aa, -
}bb 
ifee 
(ee 
!ee 
stringee 
.ee 
IsNullOrWhiteSpaceee *
(ee* +
passwordee+ 3
)ee3 4
)ee4 5
{ff 
bytegg 
[gg 
]gg 
passwordHashgg #
,gg# $
passwordSaltgg% 1
;gg1 2
CreatePasswordHashhh "
(hh" #
passwordhh# +
,hh+ ,
outhh- 0
passwordHashhh1 =
,hh= >
outhh? B
passwordSalthhC O
)hhO P
;hhP Q
userjj 
.jj 
PasswordHashjj !
=jj" #
passwordHashjj$ 0
;jj0 1
userkk 
.kk 
PasswordSaltkk !
=kk" #
passwordSaltkk$ 0
;kk0 1
}ll 
_contextnn 
.nn 
Usersnn 
.nn 
Updatenn !
(nn! "
usernn" &
)nn& '
;nn' (
_contextoo 
.oo 
SaveChangesoo  
(oo  !
)oo! "
;oo" #
}pp 	
publicrr 
voidrr 
Deleterr 
(rr 
intrr 
idrr !
)rr! "
{ss 	
vartt 
usertt 
=tt 
_contexttt 
.tt  
Userstt  %
.tt% &
Findtt& *
(tt* +
idtt+ -
)tt- .
;tt. /
ifuu 
(uu 
useruu 
==uu 
nulluu 
)uu 
{vv 
throwww 
newww 
RequestExceptionww *
(ww* +
UserExceptionCodesww+ =
.ww= >
UserNotFoundww> J
)wwJ K
;wwK L
}xx 
_contextyy 
.yy 
Usersyy 
.yy 
Removeyy !
(yy! "
useryy" &
)yy& '
;yy' (
_contextzz 
.zz 
SaveChangeszz  
(zz  !
)zz! "
;zz" #
}{{ 	
private 
static 
void 
CreatePasswordHash .
(. /
string/ 5
password6 >
,> ?
out@ C
byteD H
[H I
]I J
passwordHashK W
,W X
outY \
byte] a
[a b
]b c
passwordSaltd p
)p q
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
password
ÅÅ 
==
ÅÅ 
null
ÅÅ  
)
ÅÅ  !
throw
ÅÅ" '
new
ÅÅ( +#
ArgumentNullException
ÅÅ, A
(
ÅÅA B
$str
ÅÅB L
)
ÅÅL M
;
ÅÅM N
if
ÇÇ 
(
ÇÇ 
string
ÇÇ 
.
ÇÇ  
IsNullOrWhiteSpace
ÇÇ )
(
ÇÇ) *
password
ÇÇ* 2
)
ÇÇ2 3
)
ÇÇ3 4
throw
ÇÇ5 :
new
ÇÇ; >
ArgumentException
ÇÇ? P
(
ÇÇP Q
$strÇÇQ É
,ÇÇÉ Ñ
$strÇÇÖ è
)ÇÇè ê
;ÇÇê ë
using
ÑÑ 
(
ÑÑ 
var
ÑÑ 
hmac
ÑÑ 
=
ÑÑ 
new
ÑÑ !
System
ÑÑ" (
.
ÑÑ( )
Security
ÑÑ) 1
.
ÑÑ1 2
Cryptography
ÑÑ2 >
.
ÑÑ> ?

HMACSHA512
ÑÑ? I
(
ÑÑI J
)
ÑÑJ K
)
ÑÑK L
{
ÖÖ 
passwordSalt
ÜÜ 
=
ÜÜ 
hmac
ÜÜ #
.
ÜÜ# $
Key
ÜÜ$ '
;
ÜÜ' (
passwordHash
áá 
=
áá 
hmac
áá #
.
áá# $
ComputeHash
áá$ /
(
áá/ 0
System
áá0 6
.
áá6 7
Text
áá7 ;
.
áá; <
Encoding
áá< D
.
ááD E
UTF8
ááE I
.
ááI J
GetBytes
ááJ R
(
ááR S
password
ááS [
)
áá[ \
)
áá\ ]
;
áá] ^
}
àà 
}
ââ 	
private
ãã 
static
ãã 
bool
ãã  
VerifyPasswordHash
ãã .
(
ãã. /
string
ãã/ 5
password
ãã6 >
,
ãã> ?
byte
ãã@ D
[
ããD E
]
ããE F

storedHash
ããG Q
,
ããQ R
byte
ããS W
[
ããW X
]
ããX Y

storedSalt
ããZ d
)
ããd e
{
åå 	
if
çç 
(
çç 
password
çç 
==
çç 
null
çç  
)
çç  !
throw
çç" '
new
çç( +#
ArgumentNullException
çç, A
(
ççA B
$str
ççB L
)
ççL M
;
ççM N
if
éé 
(
éé 
string
éé 
.
éé  
IsNullOrWhiteSpace
éé )
(
éé) *
password
éé* 2
)
éé2 3
)
éé3 4
throw
éé5 :
new
éé; >
ArgumentException
éé? P
(
ééP Q
$strééQ É
,ééÉ Ñ
$strééÖ è
)ééè ê
;ééê ë
if
èè 
(
èè 

storedHash
èè 
.
èè 
Length
èè !
!=
èè" $
$num
èè% '
)
èè' (
throw
èè) .
new
èè/ 2
ArgumentException
èè3 D
(
èèD E
$str
èèE {
,
èè{ |
$strèè} ã
)èèã å
;èèå ç
if
êê 
(
êê 

storedSalt
êê 
.
êê 
Length
êê !
!=
êê" $
$num
êê% (
)
êê( )
throw
êê* /
new
êê0 3
ArgumentException
êê4 E
(
êêE F
$str
êêF }
,
êê} ~
$strêê ç
)êêç é
;êêé è
using
íí 
(
íí 
var
íí 
hmac
íí 
=
íí 
new
íí !
System
íí" (
.
íí( )
Security
íí) 1
.
íí1 2
Cryptography
íí2 >
.
íí> ?

HMACSHA512
íí? I
(
ííI J

storedSalt
ííJ T
)
ííT U
)
ííU V
{
ìì 
var
îî 
computedHash
îî  
=
îî! "
hmac
îî# '
.
îî' (
ComputeHash
îî( 3
(
îî3 4
System
îî4 :
.
îî: ;
Text
îî; ?
.
îî? @
Encoding
îî@ H
.
îîH I
UTF8
îîI M
.
îîM N
GetBytes
îîN V
(
îîV W
password
îîW _
)
îî_ `
)
îî` a
;
îîa b
for
ïï 
(
ïï 
int
ïï 
i
ïï 
=
ïï 
$num
ïï 
;
ïï 
i
ïï  !
<
ïï" #
computedHash
ïï$ 0
.
ïï0 1
Length
ïï1 7
;
ïï7 8
i
ïï9 :
++
ïï: <
)
ïï< =
{
ññ 
if
óó 
(
óó 
computedHash
óó $
[
óó$ %
i
óó% &
]
óó& '
!=
óó( *

storedHash
óó+ 5
[
óó5 6
i
óó6 7
]
óó7 8
)
óó8 9
return
óó: @
false
óóA F
;
óóF G
}
òò 
}
ôô 
return
õõ 
true
õõ 
;
õõ 
}
úú 	
}
ùù 
}ûû œI
J/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Startup.cs
	namespace 	
glovo_webapi
 
{ 
public 

class 
Startup 
{ 
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
IWebHostEnvironment "
Env# &
{' (
get) ,
;, -
}. /
readonly 
string 
AllowedOrigins &
=' (
$str) :
;: ;
public 
Startup 
( 
IWebHostEnvironment *
env+ .
,. /
IConfiguration0 >
configuration? L
)L M
{ 	
Env 
= 
env 
; 
var 
builder 
= 
new  
ConfigurationBuilder 2
(2 3
)3 4
. 
SetBasePath 
( 
env  
.  !
ContentRootPath! 0
)0 1
. 
AddJsonFile 
( 
$str /
,/ 0
optional1 9
:9 :
true; ?
,? @
reloadOnChangeA O
:O P
trueQ U
)U V
;V W
Configuration   
=   
builder   #
.  # $
Build  $ )
(  ) *
)  * +
;  + ,
}!! 	
public$$ 
void$$ 
ConfigureServices$$ %
($$% &
IServiceCollection$$& 8
services$$9 A
)$$A B
{%% 	
services&& 
.&& 
AddCors&& 
(&& 
options&& $
=>&&% '
{'' 
options(( 
.(( 
	AddPolicy(( !
(((! "
name((" &
:((& '
AllowedOrigins((( 6
,((6 7
builder))  '
=>))( *
{**  !
if++$ &
(++& '
Env++' *
.++* +
IsDevelopment+++ 8
(++8 9
)++9 :
)++: ;
{++< =
builder,,( /
.,,/ 0
AllowAnyOrigin,,0 >
(,,> ?
),,? @
.--* +
AllowAnyMethod--+ 9
(--9 :
)--: ;
...* +
AllowAnyHeader..+ 9
(..9 :
)..: ;
;..; <
}//$ %
else00$ (
{00) *
builder11( /
.11/ 0
WithOrigins110 ;
(11; <
$str11< T
,11T U
$str228 L
,22L M
$str338 Q
,33Q R
$str448 J
,44J K
$str558 K
)668 9
.77* +
AllowAnyMethod77+ 9
(779 :
)77: ;
.77; <
AllowAnyHeader77< J
(77J K
)77K L
;77L M
}88$ %
}99  !
)99! "
;99" #
}:: 
):: 
;:: 
string;; 

connection;; 
=;; 
Configuration;;  -
.;;- .
GetConnectionString;;. A
(;;A B
$str;;B U
);;U V
;;;V W
string<< 
dbUrl<< 
=<< 
Environment<< &
.<<& '"
GetEnvironmentVariable<<' =
(<<= >
$str<<> L
)<<L M
;<<M N
if== 
(== 
Env== 
.== 
IsProduction==  
(==  !
)==! "
)==" #
{>> 
Console?? 
.?? 
Write?? 
(?? 
$str?? -
)??- .
;??. /
}@@ 
ifAA 
(AA 
EnvAA 
.AA 
IsProductionAA  
(AA  !
)AA! "
&&AA# %
dbUrlAA& +
!=AA, .
nullAA/ 3
)AA3 4
{BB 
UriCC 
dbUriCC 
=CC 
newCC 
UriCC  #
(CC# $
dbUrlCC$ )
)CC) *
;CC* +
stringDD 
usernameDD 
=DD  !
dbUriDD" '
.DD' (
UserInfoDD( 0
.DD0 1
SplitDD1 6
(DD6 7
$strDD7 :
)DD: ;
[DD; <
$numDD< =
]DD= >
;DD> ?
stringEE 
passwordEE 
=EE  !
dbUriEE" '
.EE' (
UserInfoEE( 0
.EE0 1
SplitEE1 6
(EE6 7
$strEE7 :
)EE: ;
[EE; <
$numEE< =
]EE= >
;EE> ?

connectionFF 
=FF 
$strFF '
+FF( )
usernameFF* 2
+FF3 4
$strFF5 A
+FFB C
passwordFFD L
+FFM N
$strGG %
+GG& '
dbUriGG( -
.GG- .
HostGG. 2
+GG3 4
$strGG5 =
+GG> ?
dbUriGG@ E
.GGE F
PortGGF J
+GGK L
$strGGM Y
+GGZ [
dbUriGG\ a
.GGa b
AbsolutePathGGb n
.GGn o
	SubstringGGo x
(GGx y
$numGGy z
)GGz {
;GG{ |
}II 
ConsoleJJ 
.JJ 
WriteJJ 
(JJ 
$strJJ 7
+JJ7 8

connectionJJ8 B
)JJB C
;JJC D
servicesKK 
.KK 
AddDbContextKK !
<KK! "
GlovoDbContextKK" 0
>KK0 1
(KK1 2
optKK2 5
=>KK6 8
optKK9 <
.KK< =
	UseNpgsqlKK= F
(KKF G

connectionKKG Q
)KKQ R
)KKR S
;KKS T
servicesMM 
.MM 
AddCorsMM 
(MM 
)MM 
;MM 
servicesNN 
.NN 
AddControllersNN #
(NN# $
)NN$ %
;NN% &
servicesPP 
.PP 
AddAutoMapperPP "
(PP" #
	AppDomainPP# ,
.PP, -
CurrentDomainPP- :
.PP: ;
GetAssembliesPP; H
(PPH I
)PPI J
)PPJ K
;PPK L
servicesRR 
.RR 
	AddScopedRR 
<RR 
IRestaurantsServiceRR 2
,RR2 3$
NpgsqlRestaurantsServiceRR4 L
>RRL M
(RRM N
)RRN O
;RRO P
servicesSS 
.SS 
	AddScopedSS 
<SS 
IProductsServiceSS /
,SS/ 0!
NpgsqlProductsServiceSS1 F
>SSF G
(SSG H
)SSH I
;SSI J
servicesTT 
.TT 
	AddScopedTT 
<TT 
IOrdersServiceTT -
,TT- .
NpgsqlOrdersServiceTT/ B
>TTB C
(TTC D
)TTD E
;TTE F
servicesUU 
.UU 
	AddScopedUU 
<UU 
IUserServiceUU +
,UU+ ,
UserServiceUU- 8
>UU8 9
(UU9 :
)UU: ;
;UU; <
servicesWW 
.WW 

AddOptionsWW 
(WW  
)WW  !
;WW! "
servicesXX 
.XX 
	ConfigureXX 
<XX 
AppConfigurationXX /
>XX/ 0
(XX0 1
ConfigurationXX1 >
.XX> ?

GetSectionXX? I
(XXI J
$strXXJ W
)XXW X
)XXX Y
;XXY Z
services~~ 
.~~ "
AddHttpContextAccessor~~ +
(~~+ ,
)~~, -
;~~- .
} 	
public
ÇÇ 
void
ÇÇ 
	Configure
ÇÇ 
(
ÇÇ !
IApplicationBuilder
ÇÇ 1
app
ÇÇ2 5
,
ÇÇ5 6!
IWebHostEnvironment
ÇÇ7 J
env
ÇÇK N
)
ÇÇN O
{
ÉÉ 	
if
ÑÑ 
(
ÑÑ 
env
ÑÑ 
.
ÑÑ 
IsDevelopment
ÑÑ !
(
ÑÑ! "
)
ÑÑ" #
)
ÑÑ# $
{
ÖÖ 
app
ÜÜ 
.
ÜÜ '
UseDeveloperExceptionPage
ÜÜ -
(
ÜÜ- .
)
ÜÜ. /
;
ÜÜ/ 0
}
áá 
app
ãã 
.
ãã 

UseRouting
ãã 
(
ãã 
)
ãã 
;
ãã 
app
çç 
.
çç 
UseCors
çç 
(
çç 
AllowedOrigins
çç &
)
çç& '
;
çç' (
app
èè 
.
èè 
UseCors
èè 
(
èè 
x
èè 
=>
èè 
x
èè 
.
êê 
AllowAnyOrigin
êê 
(
êê  
)
êê  !
.
ëë 
AllowAnyMethod
ëë 
(
ëë  
)
ëë  !
.
íí 
AllowAnyHeader
íí 
(
íí  
)
íí  !
)
íí! "
;
íí" #
app
îî 
.
îî 
UseAuthentication
îî !
(
îî! "
)
îî" #
;
îî# $
app
ïï 
.
ïï 
UseAuthorization
ïï  
(
ïï  !
)
ïï! "
;
ïï" #
app
óó 
.
óó 
UseMiddleware
óó 
<
óó 
JwtMiddleware
óó +
>
óó+ ,
(
óó, -
)
óó- .
;
óó. /
app
ôô 
.
ôô 
UseEndpoints
ôô 
(
ôô 
	endpoints
ôô &
=>
ôô' )
{
ôô* +
	endpoints
ôô, 5
.
ôô5 6
MapControllers
ôô6 D
(
ôôD E
)
ôôE F
;
ôôF G
}
ôôH I
)
ôôI J
;
ôôJ K
}
öö 	
}
õõ 
}úú ‡
X/home/pwn/Documents/ensw/Glovo/server/glovo_webapi/glovo_webapi/Utils/ProductCategory.cs
	namespace 	
glovo_webapi
 
. 
Utils 
{ 
public 

enum 
ProductCategory 
{ 
Uncategorized 
, 
C1 

} 
} 